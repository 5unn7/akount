# Decision Journal

This directory captures significant architectural and technical decisions made during Akount development.

## Purpose

**Why capture decisions?**
- Document WHY choices were made (context fades over time)
- Prevent re-litigating settled questions
- Help future agents understand constraints and trade-offs
- Enable searching by affected files or tags

## When to Capture

Capture decisions when:
- **Multiple approaches possible** — choosing between valid alternatives
- **Architecture changes** — switching patterns, adding abstractions
- **Schema design** — model relationships, field types, cascading rules
- **Security trade-offs** — balancing usability vs security
- **Performance decisions** — caching strategies, indexing choices
- **Financial integrity** — double-entry patterns, soft delete rules

**Don't capture:**
- Obvious choices (using TypeScript for type safety)
- Following established patterns (Route → Schema → Service)
- Bug fixes (unless fixing reveals design flaw)

## Format

Use `TEMPLATE.md` as starting point. File naming: `YYYY-MM-DD-short-description.md`

**Required sections:**
- **Title** — Brief decision summary
- **Date** — When decision was made
- **Context** — Why this decision was needed
- **Decision** — What was chosen
- **Alternatives Considered** — Other options with rejection reasons
- **Consequences** — Trade-offs, future impacts
- **Files Affected** — Which files implement this decision
- **Tags** — Categories for searching

## Tags

Standard tags (use multiple):
- `architecture` — System design, patterns, structure
- `financial` — Money handling, double-entry, audit trails
- `security` — Auth, tenant isolation, input validation
- `performance` — Indexes, caching, query optimization
- `ux` — User experience, design system, workflows
- `infrastructure` — Deployment, CI/CD, monitoring
- `data-model` — Prisma schema, relations, migrations

## How Agents Use This

**During planning (`/processes:plan`):**
- Check for existing decisions on similar problems
- Capture new decisions when choosing between approaches

**During implementation (`/processes:work`):**
- Reference decisions for context on WHY code is structured a certain way
- Add new decisions for non-trivial implementation choices

**During investigation (`/processes:diagnose`):**
- Search decisions to understand constraints
- Check if "bug" is actually expected behavior based on past decision

**Searching decisions:**
```bash
# By tag
grep -l "tags: architecture" .claude/decisions/*.md

# By file affected
grep -l "apps/api/src/domains/banking" .claude/decisions/*.md

# By keyword
grep -i "soft delete" .claude/decisions/*.md
```

## Auto-Generation

**INDEX.md** is auto-generated by `regenerate-decision-index.js` (run via ARCH-26).

Don't edit INDEX.md manually — it's rebuilt from decision file frontmatter.

---

_Decision Journal v1 — Institutional memory for architectural choices._
