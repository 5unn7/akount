<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Akount — Financial Command Center</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Newsreader:ital,opsz,wght@0,6..72,300;0,6..72,400;0,6..72,500;0,6..72,600;1,6..72,300;1,6..72,400&family=Manrope:wght@300;400;500;600;700&family=JetBrains+Mono:wght@300;400;500&display=swap');

*,*::before,*::after{margin:0;padding:0;box-sizing:border-box}

:root{
  /* ── Brand Orange ── */
  --pri:#F59E0B;--pri-hover:#FBBF24;--pri-dim:rgba(245,158,11,.14);--pri-glow:rgba(245,158,11,.08);
  --pri-text:#F59E0B;--pri-active:rgba(245,158,11,.18);
  /* ── Semantic ── */
  --green:#34D399;--green-dim:rgba(52,211,153,.12);
  --red:#F87171;--red-dim:rgba(248,113,113,.12);
  --blue:#60A5FA;--blue-dim:rgba(96,165,250,.12);
  --purple:#A78BFA;--purple-dim:rgba(167,139,250,.12);
  --teal:#2DD4BF;--teal-dim:rgba(45,212,191,.12);
  --cyan:#22D3EE;
  /* ── Surfaces ── */
  --bg-0:#09090F;--bg-1:#0F0F17;--bg-2:#15151F;--bg-3:#1A1A26;--bg-4:#22222E;
  --glass:rgba(255,255,255,.025);--glass-2:rgba(255,255,255,.04);--glass-3:rgba(255,255,255,.06);
  --border:rgba(255,255,255,.06);--border-2:rgba(255,255,255,.09);--border-3:rgba(255,255,255,.13);
  /* ── Text ── */
  --t1:#F0F0F5;--t2:#9494A8;--t3:#5C5C72;--t4:#3A3A4E;
  /* ── Layout ── */
  --sidebar:68px;--topbar:52px;
  --r:14px;--r-sm:8px;--r-xs:5px;
  --ease:cubic-bezier(.16,1,.3,1);--ease2:cubic-bezier(.4,0,.2,1);
}

html{font-size:15px;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}
body{background:var(--bg-0);color:var(--t1);font-family:'Manrope',system-ui,sans-serif;height:100vh;overflow:hidden}
body::before{content:'';position:fixed;inset:0;background-image:url("data:image/svg+xml,%3Csvg viewBox='0 0 512 512' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='0.025'/%3E%3C/svg%3E");pointer-events:none;z-index:0}

/* ═══════════ LAYOUT SHELL ═══════════ */
.shell{display:grid;grid-template-columns:var(--sidebar) 1fr;grid-template-rows:var(--topbar) 1fr;height:100vh;position:relative;z-index:1}

/* ═══ SIDEBAR ═══ */
.sidebar{grid-row:1/-1;grid-column:1;display:flex;flex-direction:column;align-items:center;padding:14px 0 12px;gap:2px;border-right:1px solid var(--border);background:rgba(9,9,15,.85);backdrop-filter:blur(20px);z-index:12;overflow-y:auto;overflow-x:hidden}
.sidebar::-webkit-scrollbar{display:none}
.s-logo{width:34px;height:34px;border-radius:9px;background:linear-gradient(135deg,var(--pri),#D97706);display:flex;align-items:center;justify-content:center;font-family:'Newsreader',serif;font-weight:600;font-size:17px;color:var(--bg-0);margin-bottom:16px;cursor:pointer;transition:transform .2s,box-shadow .2s;flex-shrink:0}
.s-logo:hover{transform:scale(1.08);box-shadow:0 0 16px var(--pri-glow)}
.s-group{display:flex;flex-direction:column;align-items:center;gap:2px;width:100%}
.s-div{width:24px;height:1px;background:var(--border);margin:6px 0}
.s-btn{width:40px;height:40px;border-radius:10px;border:none;background:transparent;color:var(--t3);cursor:pointer;display:flex;align-items:center;justify-content:center;position:relative;transition:all .2s var(--ease2)}
.s-btn:hover{background:var(--glass-2);color:var(--t2)}
.s-btn.on{background:var(--pri-active);color:var(--pri)}
.s-btn .s-badge{position:absolute;top:4px;right:4px;min-width:14px;height:14px;padding:0 3px;border-radius:7px;background:var(--pri);color:var(--bg-0);font-size:8px;font-weight:700;display:flex;align-items:center;justify-content:center}
.s-btn .s-ai{position:absolute;top:6px;right:6px;width:6px;height:6px;border-radius:50%;background:var(--pri);box-shadow:0 0 6px var(--pri);animation:aip 3s ease-in-out infinite}
@keyframes aip{0%,100%{opacity:.5}50%{opacity:1;box-shadow:0 0 10px var(--pri)}}
.s-tip{position:absolute;left:52px;background:var(--bg-3);border:1px solid var(--border-2);padding:5px 10px;border-radius:var(--r-xs);font-size:11px;font-weight:500;color:var(--t1);white-space:nowrap;opacity:0;pointer-events:none;transition:opacity .12s;z-index:20;box-shadow:0 4px 12px rgba(0,0,0,.5)}
.s-btn:hover .s-tip{opacity:1}
.s-bottom{margin-top:auto;display:flex;flex-direction:column;align-items:center;gap:6px;padding-top:8px;flex-shrink:0}
.s-avatar{width:30px;height:30px;border-radius:9px;background:linear-gradient(135deg,#667eea,#764ba2);display:flex;align-items:center;justify-content:center;font-size:12px;font-weight:600;color:#fff;cursor:pointer;transition:transform .2s}
.s-avatar:hover{transform:scale(1.08)}

/* ═══ TOP BAR ═══ */
.topbar{grid-column:2;grid-row:1;display:flex;align-items:center;gap:12px;padding:0 24px;border-bottom:1px solid var(--border);background:rgba(9,9,15,.7);backdrop-filter:blur(16px);z-index:11}
/* Entity Selector */
.entity-sel{display:flex;align-items:center;gap:8px;padding:6px 12px;border-radius:var(--r-sm);cursor:pointer;transition:background .15s;position:relative;flex-shrink:0}
.entity-sel:hover{background:var(--glass-2)}
.entity-dot{width:8px;height:8px;border-radius:50%;background:var(--pri);flex-shrink:0}
.entity-name{font-size:13px;font-weight:600;color:var(--t1)}
.entity-type{font-size:10px;color:var(--t3);margin-left:2px}
.entity-chevron{color:var(--t3);font-size:10px;margin-left:4px;transition:transform .2s}
.entity-sel.open .entity-chevron{transform:rotate(180deg)}
.entity-dd{position:absolute;top:calc(100% + 6px);left:0;width:280px;background:var(--bg-2);border:1px solid var(--border-2);border-radius:var(--r);box-shadow:0 12px 40px rgba(0,0,0,.6);padding:6px;z-index:30;display:none;animation:dd-in .2s var(--ease)}
.entity-sel.open .entity-dd{display:block}
@keyframes dd-in{from{opacity:0;transform:translateY(-4px)}to{opacity:1;transform:none}}
.entity-dd-item{display:flex;align-items:center;gap:10px;padding:8px 10px;border-radius:var(--r-xs);cursor:pointer;transition:background .1s}
.entity-dd-item:hover{background:var(--glass-2)}
.entity-dd-item.active{background:var(--pri-dim)}
.entity-dd-dot{width:6px;height:6px;border-radius:50%;flex-shrink:0}
.entity-dd-info{flex:1}
.entity-dd-name{font-size:12px;font-weight:500;color:var(--t1)}
.entity-dd-meta{font-size:10px;color:var(--t3)}
.entity-dd-check{color:var(--pri);font-size:12px}
.entity-dd-hdr{padding:6px 10px 4px;font-size:10px;color:var(--t3);text-transform:uppercase;letter-spacing:.06em;font-weight:600}
/* Breadcrumb */
.breadcrumb{display:flex;align-items:center;gap:6px;font-size:12px;color:var(--t3);margin-left:8px;flex-shrink:0}
.breadcrumb span{cursor:pointer;transition:color .15s}.breadcrumb span:hover{color:var(--t2)}
.breadcrumb .bc-sep{font-size:9px;opacity:.4}
.breadcrumb .bc-active{color:var(--t2);font-weight:500}
/* Search */
.tb-search{flex:1;max-width:420px;margin:0 auto;position:relative}
.tb-search-input{width:100%;height:34px;padding:0 14px 0 34px;border-radius:var(--r-sm);border:1px solid var(--border);background:var(--glass);color:var(--t1);font-family:'Manrope',sans-serif;font-size:12px;outline:none;transition:all .2s}
.tb-search-input::placeholder{color:var(--t4)}
.tb-search-input:focus{border-color:var(--pri);box-shadow:0 0 0 2px var(--pri-glow);background:var(--bg-2)}
.tb-search-icon{position:absolute;left:11px;top:50%;transform:translateY(-50%);color:var(--t4);font-size:13px;pointer-events:none}
.tb-search-kbd{position:absolute;right:8px;top:50%;transform:translateY(-50%);font-family:'JetBrains Mono',monospace;font-size:9px;padding:2px 5px;border-radius:3px;border:1px solid var(--border);color:var(--t4);pointer-events:none}
/* Topbar Right */
.tb-right{display:flex;align-items:center;gap:4px;flex-shrink:0}
.tb-btn{width:34px;height:34px;border-radius:var(--r-sm);border:none;background:transparent;color:var(--t3);cursor:pointer;display:flex;align-items:center;justify-content:center;position:relative;transition:all .15s}
.tb-btn:hover{background:var(--glass-2);color:var(--t2)}
.tb-btn .notif-dot{position:absolute;top:6px;right:6px;width:6px;height:6px;border-radius:50%;background:var(--red);box-shadow:0 0 4px var(--red)}
.tb-divider{width:1px;height:24px;background:var(--border);margin:0 4px}

/* ═══ MAIN SCROLL AREA ═══ */
.main{grid-column:2;grid-row:2;overflow-y:auto;overflow-x:hidden;position:relative}
.main::-webkit-scrollbar{width:5px}.main::-webkit-scrollbar-track{background:transparent}.main::-webkit-scrollbar-thumb{background:var(--border);border-radius:3px}.main::-webkit-scrollbar-thumb:hover{background:rgba(255,255,255,.1)}

/* ═══ DOMAIN VIEW ═══ */
.view{padding:28px 32px 100px;display:none;opacity:0;transform:translateY(8px);transition:opacity .35s var(--ease),transform .35s var(--ease)}
.view.on{display:block;opacity:1;transform:none}

/* ═══ PAGE HEADER ═══ */
.page-hdr{display:flex;align-items:flex-end;justify-content:space-between;margin-bottom:24px;flex-wrap:wrap;gap:12px}
.page-title{font-family:'Newsreader',serif;font-size:1.55rem;font-weight:400;color:var(--t1)}
.page-sub{font-size:12px;color:var(--t3);margin-top:2px}
.page-actions{display:flex;gap:8px}
.btn{padding:7px 16px;border-radius:var(--r-sm);border:1px solid var(--border);background:transparent;color:var(--t2);font-size:12px;font-family:'Manrope',sans-serif;font-weight:500;cursor:pointer;transition:all .15s;display:flex;align-items:center;gap:6px;white-space:nowrap}
.btn:hover{background:var(--glass-2);color:var(--t1);border-color:var(--border-2)}
.btn.pri{background:var(--pri-dim);border-color:rgba(245,158,11,.22);color:var(--pri)}
.btn.pri:hover{background:rgba(245,158,11,.22)}
.btn.solid{background:var(--pri);border-color:var(--pri);color:var(--bg-0);font-weight:600}
.btn.solid:hover{background:var(--pri-hover)}

/* ═══ PULSE ═══ */
.pulse{text-align:center;padding:24px 0 28px}
.p-orb-w{position:relative;width:64px;height:64px;margin:0 auto 24px}
.p-orb{width:64px;height:64px;border-radius:50%;background:radial-gradient(circle at 35% 35%,#FCD34D,#F59E0B,#D97706);box-shadow:0 0 36px rgba(245,158,11,.22),0 0 72px rgba(245,158,11,.08),inset 0 -3px 10px rgba(0,0,0,.2);animation:pb 4s ease-in-out infinite}
.p-r1{position:absolute;inset:-9px;border-radius:50%;border:1px solid rgba(245,158,11,.1);animation:pr 4s ease-in-out infinite}
.p-r2{position:absolute;inset:-20px;border-radius:50%;border:1px solid rgba(245,158,11,.05);animation:pr 4s ease-in-out infinite .5s}
@keyframes pb{0%,100%{transform:scale(1);box-shadow:0 0 36px rgba(245,158,11,.22),0 0 72px rgba(245,158,11,.08)}50%{transform:scale(1.06);box-shadow:0 0 52px rgba(245,158,11,.3),0 0 100px rgba(245,158,11,.12)}}
@keyframes pr{0%,100%{transform:scale(1);opacity:.4}50%{transform:scale(1.07);opacity:.9}}
.p-text{font-family:'Newsreader',serif;font-style:italic;font-weight:300;font-size:1.15rem;line-height:1.7;color:var(--t2);max-width:520px;margin:0 auto}
.p-text .hl{color:var(--t1);font-weight:400}.p-text .pos{color:var(--green)}.p-text .warn{color:var(--pri)}
.curr-strip{display:flex;gap:18px;justify-content:center;margin-top:14px}
.curr-item{display:flex;align-items:center;gap:6px;font-size:11px;color:var(--t3)}
.curr-item .c-code{font-weight:600;color:var(--t2);min-width:26px}
.curr-item .c-bar{height:3px;border-radius:2px;background:var(--pri)}
.curr-item .c-amt{color:var(--t2);font-variant-numeric:tabular-nums}
.curr-item .c-fx{font-size:9px;font-family:'JetBrains Mono',monospace}
.c-fx.up{color:var(--green)}.c-fx.dn{color:var(--red)}

/* ═══ STATS GRID ═══ */
.stats{display:grid;gap:10px;margin:24px 0}
.stats-4{grid-template-columns:repeat(4,1fr)}
.stats-3{grid-template-columns:repeat(3,1fr)}
.stats-5{grid-template-columns:repeat(5,1fr)}
.st{background:var(--glass);border:1px solid var(--border);border-radius:var(--r);padding:16px 18px;transition:all .2s var(--ease2);cursor:default}
.st:hover{border-color:var(--border-2);background:var(--glass-2)}
.st-label{font-size:11px;color:var(--t3);margin-bottom:6px;text-transform:uppercase;letter-spacing:.05em;font-weight:500}
.st-val{font-family:'JetBrains Mono',monospace;font-size:1.25rem;color:var(--t1);letter-spacing:-.02em}
.st-trend{font-size:10px;margin-top:5px;font-family:'JetBrains Mono',monospace}
.st-trend.up{color:var(--green)}.st-trend.dn{color:var(--red)}.st-trend.flat{color:var(--t3)}

/* ═══ SECTION ═══ */
.sec{margin:28px 0}
.sec-h{display:flex;align-items:center;justify-content:space-between;margin-bottom:14px;flex-wrap:wrap;gap:8px}
.sec-t{font-family:'Newsreader',serif;font-size:1rem;font-weight:400;color:var(--t2)}
.sec-m{font-size:10px;color:var(--t3);font-family:'JetBrains Mono',monospace}
.sec-tabs{display:flex;gap:2px;background:var(--glass);border-radius:var(--r-sm);padding:2px}
.sec-tab{padding:5px 12px;border-radius:var(--r-xs);border:none;background:transparent;color:var(--t3);font-size:11px;font-family:'Manrope',sans-serif;font-weight:500;cursor:pointer;transition:all .15s}
.sec-tab:hover{color:var(--t2)}
.sec-tab.on{background:var(--bg-3);color:var(--t1)}

/* ═══ TWO-COL LAYOUT (Overview) ═══ */
.two-col{display:grid;grid-template-columns:1fr 340px;gap:24px;align-items:start}
@media(max-width:1100px){.two-col{grid-template-columns:1fr}}
.right-col{display:flex;flex-direction:column;gap:16px}

/* ═══ RIVER ═══ */
.river-w{width:100%;height:170px;border-radius:var(--r);background:var(--glass);border:1px solid var(--border);position:relative;overflow:hidden;cursor:crosshair}
.river-w canvas{width:100%;height:100%}
.river-today{position:absolute;top:0;bottom:0;left:42%;width:1px;background:linear-gradient(180deg,transparent,var(--pri),transparent);opacity:.3}
.river-today-l{position:absolute;top:5px;left:42%;transform:translateX(-50%);font-size:8px;font-family:'JetBrains Mono',monospace;color:var(--pri);opacity:.5;text-transform:uppercase;letter-spacing:.08em}
.river-tip{position:absolute;background:var(--bg-3);border:1px solid var(--border-2);padding:6px 10px;border-radius:var(--r-xs);font-size:10px;pointer-events:none;opacity:0;transition:opacity .12s;z-index:5;box-shadow:0 6px 20px rgba(0,0,0,.5)}
.river-tip.show{opacity:1}
.river-tip .tt-v{font-family:'JetBrains Mono',monospace;font-weight:500;color:var(--t1);font-size:12px}
.river-tip .tt-l{color:var(--t3);margin-top:1px}
.river-ax{display:flex;justify-content:space-between;margin-top:5px;padding:0 2px}
.river-ax span{font-size:9px;color:var(--t4);font-family:'JetBrains Mono',monospace}

/* ═══ ACTION CARDS ═══ */
.ac{background:var(--glass);border:1px solid var(--border);border-radius:var(--r);padding:14px 16px;margin-bottom:6px;cursor:pointer;transition:all .2s var(--ease2);display:flex;align-items:center;gap:12px;position:relative}
.ac:hover{border-color:var(--border-2);transform:translateY(-1px);box-shadow:0 4px 16px rgba(0,0,0,.2)}
.ac.sel{border-color:rgba(245,158,11,.35);box-shadow:0 0 0 1px rgba(245,158,11,.25),0 4px 16px rgba(245,158,11,.06)}
.ac-i{width:34px;height:34px;border-radius:8px;display:flex;align-items:center;justify-content:center;font-size:15px;flex-shrink:0}
.ac-i.urg{background:var(--red-dim)}.ac-i.att{background:var(--pri-dim)}.ac-i.ai{background:linear-gradient(135deg,var(--pri-dim),var(--purple-dim))}
.ac-b{flex:1;min-width:0}
.ac-t{font-size:12px;font-weight:500;color:var(--t1);margin-bottom:2px}
.ac-m{font-size:10px;color:var(--t3);display:flex;align-items:center;gap:5px}
.ac-m .dot{width:2px;height:2px;border-radius:50%;background:var(--t4)}

/* ═══ AI BRIEF (right col) ═══ */
.ai-brief{background:linear-gradient(135deg,rgba(245,158,11,.03),rgba(167,139,250,.03));border:1px solid rgba(245,158,11,.08);border-radius:var(--r);padding:16px 18px;position:relative;overflow:hidden}
.ai-brief::before{content:'';position:absolute;top:-30px;right:-30px;width:90px;height:90px;border-radius:50%;background:radial-gradient(circle,rgba(245,158,11,.05),transparent);pointer-events:none}
.ai-hdr{display:flex;align-items:center;gap:7px;margin-bottom:10px}
.ai-dot-sm{width:6px;height:6px;border-radius:50%;background:var(--pri);box-shadow:0 0 6px var(--pri)}
.ai-label{font-size:9px;font-weight:700;text-transform:uppercase;letter-spacing:.08em;color:var(--pri);opacity:.8}
.ai-time{font-size:9px;color:var(--t3);font-family:'JetBrains Mono',monospace;margin-left:auto}
.ai-body{font-family:'Newsreader',serif;font-size:.9rem;line-height:1.7;color:var(--t2);font-style:italic}
.ai-body strong{font-weight:400;color:var(--t1)}

/* ═══ ACCOUNT CARDS ═══ */
.acct-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));gap:10px;margin:16px 0}
.acct{background:var(--glass);border:1px solid var(--border);border-radius:var(--r);padding:16px 18px;cursor:pointer;transition:all .2s var(--ease2);position:relative;overflow:hidden}
.acct:hover{border-color:var(--border-2);transform:translateY(-1px);box-shadow:0 6px 24px rgba(0,0,0,.25)}
.acct::after{content:'';position:absolute;bottom:0;left:0;right:0;height:2px}
.acct.chk::after{background:var(--pri)}.acct.sav::after{background:var(--blue)}.acct.crd::after{background:var(--purple)}
.acct-bank{font-size:10px;color:var(--t3);text-transform:uppercase;letter-spacing:.04em;font-weight:500;margin-bottom:3px}
.acct-name{font-size:13px;font-weight:500;color:var(--t1);margin-bottom:10px}
.acct-bal{font-family:'JetBrains Mono',monospace;font-size:1.2rem;color:var(--t1);letter-spacing:-.02em}
.acct-cur{font-size:.7rem;color:var(--t3);margin-left:3px}
.acct-foot{display:flex;justify-content:space-between;align-items:center;margin-top:10px;padding-top:10px;border-top:1px solid var(--border)}
.acct-foot span{font-size:10px;color:var(--t3)}
.acct-sync{display:flex;align-items:center;gap:3px;font-size:9px;color:var(--t3)}
.acct-sync .dot{width:5px;height:5px;border-radius:50%;background:var(--green)}

/* ═══ TRANSACTION TABLE ═══ */
.txn-section{margin:24px 0}
.txn-filters{display:flex;gap:6px;margin-bottom:12px;flex-wrap:wrap;align-items:center}
.txn-filter{padding:5px 12px;border-radius:20px;border:1px solid var(--border);background:transparent;color:var(--t3);font-size:11px;font-family:'Manrope',sans-serif;cursor:pointer;transition:all .15s}
.txn-filter:hover{border-color:var(--border-2);color:var(--t2)}
.txn-filter.on{background:var(--pri-dim);border-color:rgba(245,158,11,.2);color:var(--pri)}
.txn-count{font-size:10px;color:var(--t4);margin-left:auto;font-family:'JetBrains Mono',monospace}
/* Table */
.txn-table{width:100%;border-collapse:separate;border-spacing:0}
.txn-table th{text-align:left;padding:8px 12px;font-size:10px;color:var(--t3);text-transform:uppercase;letter-spacing:.05em;font-weight:500;border-bottom:1px solid var(--border);position:sticky;top:0;background:var(--bg-1);z-index:1;cursor:pointer;transition:color .15s;white-space:nowrap;user-select:none}
.txn-table th:hover{color:var(--t2)}
.txn-table th.right{text-align:right}
.txn-table th .sort{font-size:8px;margin-left:3px;opacity:.4}
.txn-table td{padding:10px 12px;border-bottom:1px solid var(--border);font-size:12px;vertical-align:middle;transition:background .1s}
.txn-table tr.txn-row{cursor:pointer}
.txn-table tr.txn-row:hover td{background:var(--glass)}
.txn-table tr.uncat{border-left:2px solid var(--pri)}
.txn-table tr.uncat td:first-child{border-left:2px solid var(--pri);padding-left:10px}
.txn-desc-cell{display:flex;align-items:center;gap:10px}
.txn-ico{width:30px;height:30px;border-radius:7px;display:flex;align-items:center;justify-content:center;font-size:13px;flex-shrink:0;background:var(--glass-2)}
.txn-desc{font-weight:500;color:var(--t1);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:220px}
.txn-cat-tag{display:inline-flex;padding:2px 7px;border-radius:3px;font-size:9px;font-weight:500;background:var(--glass-2);color:var(--t2)}
.txn-cat-tag.uncat{background:var(--pri-dim);color:var(--pri)}
.txn-cat-tag.matched{background:var(--green-dim);color:var(--green)}
.txn-recon{display:flex;align-items:center;gap:4px;font-size:10px}
.txn-recon .r-dot{width:6px;height:6px;border-radius:50%}
.txn-recon .r-dot.ok{background:var(--green)}.txn-recon .r-dot.pend{background:var(--pri)}.txn-recon .r-dot.no{background:var(--t4)}
.txn-amt{font-family:'JetBrains Mono',monospace;font-size:12px;font-weight:500;text-align:right;white-space:nowrap}
.txn-amt.in{color:var(--green)}.txn-amt.out{color:var(--t1)}
.txn-date-cell{font-size:10px;color:var(--t3);font-family:'JetBrains Mono',monospace;white-space:nowrap}
.txn-acct-cell{font-size:10px;color:var(--t3);white-space:nowrap}

/* ═══ RECON BAR ═══ */
.recon-sec{margin:16px 0}
.recon-bar-w{display:flex;align-items:center;gap:10px}
.recon-bar{flex:1;height:5px;border-radius:3px;background:var(--glass-2);overflow:hidden}
.recon-fill{height:100%;border-radius:3px;background:linear-gradient(90deg,var(--pri),var(--green));transition:width 1.2s var(--ease)}
.recon-pct{font-family:'JetBrains Mono',monospace;font-size:12px;color:var(--pri);min-width:40px;text-align:right}

/* ═══ INVOICE TABLE ═══ */
.inv-table{width:100%;border-collapse:separate;border-spacing:0}
.inv-table th{text-align:left;padding:8px 12px;font-size:10px;color:var(--t3);text-transform:uppercase;letter-spacing:.05em;font-weight:500;border-bottom:1px solid var(--border);white-space:nowrap}
.inv-table th.right{text-align:right}
.inv-table td{padding:12px;border-bottom:1px solid var(--border);font-size:12px;vertical-align:middle}
.inv-table tr.inv-row{cursor:pointer;transition:background .1s}
.inv-table tr.inv-row:hover td{background:var(--glass)}
.inv-num{font-family:'JetBrains Mono',monospace;font-size:11px;color:var(--pri)}
.inv-client{font-weight:500;color:var(--t1)}
.inv-client-sub{font-size:10px;color:var(--t3)}
.inv-amt{font-family:'JetBrains Mono',monospace;font-size:12px;text-align:right}
.inv-amt .cur{font-size:9px;color:var(--t3);margin-left:2px}
.inv-badge{display:inline-flex;padding:3px 8px;border-radius:12px;font-size:9px;font-weight:600;text-transform:uppercase;letter-spacing:.03em}
.inv-badge.paid{background:var(--green-dim);color:var(--green)}
.inv-badge.pending{background:var(--pri-dim);color:var(--pri)}
.inv-badge.overdue{background:var(--red-dim);color:var(--red)}
.inv-badge.draft{background:var(--glass-2);color:var(--t3)}
.inv-badge.sent{background:var(--blue-dim);color:var(--blue)}
.inv-due{font-size:11px;color:var(--t3);font-family:'JetBrains Mono',monospace}
.inv-due.late{color:var(--red)}
.inv-progress{display:flex;align-items:center;gap:6px}
.inv-pbar{width:48px;height:3px;border-radius:2px;background:var(--glass-2);overflow:hidden}
.inv-pfill{height:100%;border-radius:2px}

/* ═══ AGING BAR ═══ */
.aging-bar{display:flex;height:6px;border-radius:3px;overflow:hidden;gap:2px;margin:10px 0}
.aging-seg{border-radius:2px}
.aging-legend{display:flex;gap:16px;flex-wrap:wrap}
.aging-item{display:flex;align-items:center;gap:5px;font-size:10px;color:var(--t3)}
.aging-dot{width:6px;height:6px;border-radius:2px}

/* ═══ AI INSIGHTS ═══ */
.ai-card{background:var(--glass);border:1px solid var(--border);border-radius:var(--r);padding:18px 20px;margin-bottom:10px;cursor:pointer;transition:all .2s var(--ease2)}
.ai-card:hover{border-color:var(--border-2);transform:translateY(-1px);box-shadow:0 4px 16px rgba(0,0,0,.2)}
.ai-type{font-size:9px;font-weight:700;text-transform:uppercase;letter-spacing:.07em;margin-bottom:6px;display:flex;align-items:center;gap:5px}
.ai-type.saving{color:var(--green)}.ai-type.warning{color:var(--pri)}.ai-type.growth{color:var(--blue)}.ai-type.risk{color:var(--red)}
.ai-card-title{font-size:13px;font-weight:500;color:var(--t1);margin-bottom:5px}
.ai-card-body{font-size:12px;color:var(--t2);line-height:1.65}
.ai-card-foot{display:flex;align-items:center;justify-content:space-between;margin-top:12px}
.ai-conf{display:flex;align-items:center;gap:5px;font-size:10px;color:var(--t3)}
.ai-conf-bar{width:50px;height:2px;border-radius:1px;background:var(--glass-2);overflow:hidden}
.ai-conf-fill{height:100%;border-radius:1px;background:var(--pri)}

/* ═══ DETAIL PANEL ═══ */
.d-overlay{position:fixed;inset:0;background:rgba(9,9,15,.45);z-index:50;display:none;opacity:0;transition:opacity .25s}
.d-overlay.vis{display:block;opacity:1}
.d-panel{position:fixed;top:0;right:0;bottom:0;width:420px;background:var(--bg-1);border-left:1px solid var(--border);z-index:51;padding:28px;display:none;transform:translateX(100%);transition:transform .3s var(--ease);overflow-y:auto}
.d-panel.vis{display:block;transform:translateX(0)}
.d-close{position:absolute;top:14px;right:14px;width:28px;height:28px;border-radius:7px;border:1px solid var(--border);background:transparent;color:var(--t3);cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:13px;transition:all .15s}
.d-close:hover{background:var(--glass-2);color:var(--t1)}
.d-badge{display:inline-block;padding:3px 9px;border-radius:12px;font-size:9px;font-weight:600;margin-bottom:12px}
.d-badge.overdue{background:var(--red-dim);color:var(--red)}
.d-badge.pending{background:var(--pri-dim);color:var(--pri)}
.d-badge.paid{background:var(--green-dim);color:var(--green)}
.d-badge.uncat{background:var(--pri-dim);color:var(--pri)}
.d-title{font-family:'Newsreader',serif;font-size:1.3rem;font-weight:400;margin-bottom:3px}
.d-sub{font-size:12px;color:var(--t3);margin-bottom:18px}
.d-amount{font-family:'JetBrains Mono',monospace;font-size:1.6rem;letter-spacing:-.02em;margin-bottom:24px}
.d-amount .cur{font-size:.8rem;color:var(--t3);margin-left:3px}
.d-row{display:flex;justify-content:space-between;align-items:center;padding:9px 0;border-bottom:1px solid var(--border)}
.d-row-l{font-size:11px;color:var(--t3)}.d-row-v{font-size:11px;color:var(--t1);font-variant-numeric:tabular-nums}
.d-actions{display:flex;flex-direction:column;gap:5px;margin-top:20px}

/* ═══ COMMAND PALETTE ═══ */
.cmd-overlay{position:fixed;inset:0;background:rgba(9,9,15,.6);backdrop-filter:blur(5px);z-index:100;display:none;align-items:flex-start;justify-content:center;padding-top:16vh}
.cmd-overlay.vis{display:flex}
.cmd-box{width:520px;background:var(--bg-2);border:1px solid var(--border-2);border-radius:var(--r);box-shadow:0 20px 60px rgba(0,0,0,.6);overflow:hidden;animation:ci .18s var(--ease)}
@keyframes ci{from{opacity:0;transform:translateY(-6px) scale(.99)}to{opacity:1;transform:none}}
.cmd-input{width:100%;padding:14px 18px;background:transparent;border:none;border-bottom:1px solid var(--border);color:var(--t1);font-family:'Manrope',sans-serif;font-size:14px;outline:none}
.cmd-input::placeholder{color:var(--t4)}
.cmd-results{padding:5px;max-height:300px;overflow-y:auto}
.cmd-item{padding:8px 10px;border-radius:var(--r-xs);display:flex;align-items:center;gap:10px;cursor:pointer;transition:background .08s}
.cmd-item:hover,.cmd-item.sel{background:var(--glass-2)}
.cmd-ii{width:26px;height:26px;display:flex;align-items:center;justify-content:center;border-radius:5px;background:var(--glass);color:var(--t2);font-size:12px}
.cmd-it{flex:1}.cmd-itn{font-size:12px;color:var(--t1)}.cmd-itd{font-size:9px;color:var(--t3)}
.cmd-ik{font-family:'JetBrains Mono',monospace;font-size:9px;color:var(--t4)}
.cmd-foot{padding:6px 14px;border-top:1px solid var(--border);display:flex;gap:14px}
.cmd-foot span{font-size:9px;color:var(--t4);display:flex;align-items:center;gap:3px}
.cmd-foot kbd{font-family:'JetBrains Mono',monospace;padding:1px 3px;border-radius:2px;border:1px solid var(--border);font-size:8px}

/* ═══ TOAST ═══ */
.toast{position:fixed;bottom:48px;left:50%;transform:translateX(-50%) translateY(16px);background:var(--bg-3);border:1px solid var(--border-2);border-radius:var(--r-sm);padding:10px 18px;font-size:12px;color:var(--t1);box-shadow:0 6px 24px rgba(0,0,0,.5);opacity:0;transition:all .3s var(--ease);z-index:200;display:flex;align-items:center;gap:8px;pointer-events:none}
.toast.vis{opacity:1;transform:translateX(-50%) translateY(0)}
.toast .t-ico{color:var(--green)}

/* ═══ KEYBOARD BAR ═══ */
.kb{position:fixed;bottom:12px;left:50%;transform:translateX(-50%);display:flex;gap:12px;padding:5px 12px;border-radius:16px;background:var(--bg-2);border:1px solid var(--border);z-index:5;opacity:0;animation:kbi .5s ease 3s forwards}
@keyframes kbi{to{opacity:1}}
.kb span{display:flex;align-items:center;gap:4px;font-size:9px;color:var(--t3)}
.kb kbd{font-family:'JetBrains Mono',monospace;font-size:8px;padding:1px 4px;border-radius:2px;border:1px solid var(--border);color:var(--t2)}

/* ═══ ZEN ═══ */
.zen{text-align:center;padding:50px 0}
.zen-text{font-family:'Newsreader',serif;font-style:italic;color:var(--t3);font-size:.95rem}
.zen-art{margin:28px auto 0;width:180px;height:50px;position:relative}
.zen-line{position:absolute;left:10%;right:10%;height:1px;background:var(--t4);opacity:.12}
.zen-line:nth-child(1){top:12px}.zen-line:nth-child(2){top:22px}.zen-line:nth-child(3){top:32px}.zen-line:nth-child(4){top:42px}
.zen-stone{position:absolute;border-radius:50%;background:var(--t3);opacity:.15}
.zen-stone:nth-child(5){width:12px;height:12px;left:42%;top:18px}.zen-stone:nth-child(6){width:8px;height:8px;left:58%;top:28px}.zen-stone:nth-child(7){width:5px;height:5px;left:34%;top:33px}

/* ═══ LIGHT THEME ═══ */
.light{--bg-0:#F5F5F7;--bg-1:#EEEEF1;--bg-2:#E5E5EA;--bg-3:#D8D8DE;--bg-4:#CBCBD3;
  --glass:rgba(0,0,0,.03);--glass-2:rgba(0,0,0,.05);--glass-3:rgba(0,0,0,.07);
  --border:rgba(0,0,0,.07);--border-2:rgba(0,0,0,.1);--border-3:rgba(0,0,0,.15);
  --t1:#1A1A2E;--t2:#4A4A5C;--t3:#7A7A8E;--t4:#A0A0AE;
  --pri:#D97706;--pri-hover:#B45309;--pri-dim:rgba(217,119,6,.1);--pri-glow:rgba(217,119,6,.06);
  --pri-text:#D97706;--pri-active:rgba(217,119,6,.12)}
.light body::before{opacity:0}
.light .sidebar{background:rgba(245,245,247,.92)}
.light .topbar{background:rgba(245,245,247,.85)}
.light .p-orb{box-shadow:0 0 36px rgba(217,119,6,.18),0 0 72px rgba(217,119,6,.06),inset 0 -3px 10px rgba(0,0,0,.1)}

/* ═══ THEME TOGGLE ═══ */
.theme-tog{display:flex;align-items:center;gap:6px;cursor:pointer}
.theme-tog .t-icon{font-size:12px;color:var(--t3);transition:color .2s}
.theme-tog .t-track{width:32px;height:16px;border-radius:8px;background:var(--glass-2);border:1px solid var(--border);position:relative;transition:all .3s}
.theme-tog .t-thumb{width:12px;height:12px;border-radius:50%;background:var(--pri);position:absolute;top:1px;left:1px;transition:transform .3s var(--ease);box-shadow:0 0 6px var(--pri-glow)}
.theme-tog.light-on .t-thumb{transform:translateX(16px)}
.theme-tog:hover .t-track{border-color:var(--border-2)}

/* ═══ FONT SIZE ═══ */
.font-ctl{display:flex;align-items:center;gap:2px}
.font-btn{width:26px;height:26px;border-radius:var(--r-xs);border:1px solid var(--border);background:transparent;color:var(--t3);cursor:pointer;font-family:'Manrope',sans-serif;font-size:10px;font-weight:600;display:flex;align-items:center;justify-content:center;transition:all .15s}
.font-btn:hover{background:var(--glass-2);color:var(--t2);border-color:var(--border-2)}
.font-btn.active{background:var(--pri-dim);border-color:rgba(245,158,11,.2);color:var(--pri)}

/* ═══ ENHANCED CMD PALETTE ═══ */
.cmd-cats{display:flex;gap:2px;padding:4px 12px;border-bottom:1px solid var(--border)}
.cmd-cat{padding:4px 10px;border-radius:12px;border:none;background:transparent;color:var(--t3);font-size:10px;font-family:'Manrope',sans-serif;font-weight:500;cursor:pointer;transition:all .15s}
.cmd-cat:hover{color:var(--t2)}
.cmd-cat.on{background:var(--pri-dim);color:var(--pri)}
.cmd-sec-label{padding:6px 12px 3px;font-size:9px;color:var(--t4);text-transform:uppercase;letter-spacing:.06em;font-weight:600}
.cmd-ai-row{padding:8px 12px;border-top:1px solid var(--border);display:flex;align-items:center;gap:8px}
.cmd-ai-dot{width:6px;height:6px;border-radius:50%;background:var(--pri);box-shadow:0 0 6px var(--pri);flex-shrink:0}
.cmd-ai-hint{font-size:10px;color:var(--t3);font-style:italic}
.cmd-ai-resp{padding:10px 14px;background:linear-gradient(135deg,rgba(245,158,11,.04),rgba(167,139,250,.04));border-top:1px solid rgba(245,158,11,.08);font-family:'Newsreader',serif;font-size:12px;color:var(--t2);line-height:1.65;font-style:italic;display:none}
.cmd-ai-resp.vis{display:block}
.cmd-ai-resp strong{color:var(--t1);font-weight:400}

/* ═══ COLLAPSIBLE AI CARDS ═══ */
.ai-card .ai-expand{display:none;margin-top:10px;padding-top:10px;border-top:1px solid var(--border);animation:fi .3s var(--ease)}
.ai-card.expanded .ai-expand{display:block}
.ai-card .ai-peek{font-size:11px;color:var(--t3);margin-top:4px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;transition:opacity .2s}
.ai-card.expanded .ai-peek{display:none}
.ai-card .ai-chevron{color:var(--t4);font-size:10px;transition:transform .2s;margin-left:auto}
.ai-card.expanded .ai-chevron{transform:rotate(180deg)}

/* ═══ MINI SPARKLINE ═══ */
.spark-row{display:flex;gap:10px;margin:16px 0}
.spark-card{flex:1;background:var(--glass);border:1px solid var(--border);border-radius:var(--r);padding:14px 16px;transition:all .2s var(--ease2);cursor:default}
.spark-card:hover{border-color:var(--border-2);background:var(--glass-2)}
.spark-label{font-size:10px;color:var(--t3);text-transform:uppercase;letter-spacing:.04em;font-weight:500;margin-bottom:4px}
.spark-val{font-family:'JetBrains Mono',monospace;font-size:1rem;color:var(--t1)}
.spark-line{height:24px;margin-top:6px}
.spark-line svg{width:100%;height:24px}

/* ═══ UPCOMING PAYMENTS ═══ */
.upcoming-item{display:flex;align-items:center;gap:10px;padding:8px 0;border-bottom:1px solid var(--border)}
.upcoming-item:last-child{border:none}
.upcoming-date{width:36px;height:36px;border-radius:var(--r-sm);background:var(--glass-2);display:flex;flex-direction:column;align-items:center;justify-content:center;flex-shrink:0}
.upcoming-date .u-day{font-family:'JetBrains Mono',monospace;font-size:13px;font-weight:600;color:var(--t1);line-height:1}
.upcoming-date .u-mon{font-size:8px;color:var(--t3);text-transform:uppercase;letter-spacing:.04em}
.upcoming-info{flex:1;min-width:0}
.upcoming-name{font-size:12px;font-weight:500;color:var(--t1);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.upcoming-meta{font-size:10px;color:var(--t3)}
.upcoming-amt{font-family:'JetBrains Mono',monospace;font-size:12px;text-align:right;white-space:nowrap}

/* ═══ ANIMATIONS ═══ */
.fi{opacity:0;transform:translateY(10px);animation:fi .45s var(--ease) forwards}
.fi1{animation-delay:.06s}.fi2{animation-delay:.12s}.fi3{animation-delay:.2s}.fi4{animation-delay:.28s}.fi5{animation-delay:.36s}.fi6{animation-delay:.44s}
@keyframes fi{to{opacity:1;transform:none}}
</style>
</head>
<body>

<div class="shell">
  <!-- ═══ SIDEBAR ═══ -->
  <nav class="sidebar">
    <div class="s-logo" onclick="switchDomain('overview')">A</div>
    <div class="s-group">
      <button class="s-btn on" data-d="overview"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><rect x="3" y="3" width="7" height="7" rx="1.5"/><rect x="14" y="3" width="7" height="7" rx="1.5"/><rect x="3" y="14" width="7" height="7" rx="1.5"/><rect x="14" y="14" width="7" height="7" rx="1.5"/></svg><span class="s-tip">Overview</span></button>
      <button class="s-btn" data-d="banking"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M3 21h18M3 10h18M5 6l7-3 7 3M4 10v11M20 10v11M8 14v3M12 14v3M16 14v3"/></svg><span class="s-badge">3</span><span class="s-tip">Banking</span></button>
      <button class="s-btn" data-d="invoicing"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/><path d="M14 2v6h6M16 13H8M16 17H8M10 9H8"/></svg><span class="s-badge">1</span><span class="s-tip">Invoicing</span></button>
      <button class="s-btn" data-d="vendors"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M16 4h2a2 2 0 012 2v14a2 2 0 01-2 2H6a2 2 0 01-2-2V6a2 2 0 012-2h2"/><rect x="8" y="2" width="8" height="4" rx="1"/></svg><span class="s-tip">Vendors</span></button>
      <div class="s-div"></div>
      <button class="s-btn" data-d="accounting"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M4 7V4h16v3M9 20h6M12 4v16"/></svg><span class="s-tip">Accounting</span></button>
      <button class="s-btn" data-d="planning"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></svg><span class="s-tip">Planning</span></button>
      <div class="s-div"></div>
      <button class="s-btn" data-d="ai"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M12 2a7 7 0 017 7c0 2.38-1.19 4.47-3 5.74V17a2 2 0 01-2 2h-4a2 2 0 01-2-2v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 017-7z"/><path d="M9 21h6"/></svg><span class="s-ai"></span><span class="s-tip">AI Advisor</span></button>
      <button class="s-btn" data-d="services"><svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 01-2.83 2.83l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-4 0v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83-2.83l.06-.06A1.65 1.65 0 004.68 15a1.65 1.65 0 00-1.51-1H3a2 2 0 010-4h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 012.83-2.83l.06.06A1.65 1.65 0 009 4.68V3a2 2 0 014 0v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 2.83l-.06.06A1.65 1.65 0 0019.4 9c.26.46.4.99.51 1H21a2 2 0 010 4h-.09a1.65 1.65 0 00-1.51 1z"/></svg><span class="s-tip">Services</span></button>
    </div>
    <div class="s-bottom">
      <button class="s-btn" title="Settings"><svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-4 0v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83-2.83l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 010-4h.09a1.65 1.65 0 001.51-1 1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 012.83-2.83l.06.06A1.65 1.65 0 009 4.68a1.65 1.65 0 001-1.51V3a2 2 0 014 0v.09a1.65 1.65 0 001 1.51c.46.26.99.4 1 .51"/></svg></button>
      <div class="s-avatar" title="Sunny M.">S</div>
    </div>
  </nav>

  <!-- ═══ TOP BAR ═══ -->
  <header class="topbar">
    <div class="entity-sel" id="entitySel" onclick="this.classList.toggle('open')">
      <div class="entity-dot"></div>
      <span class="entity-name" id="entityName">Marakana Corp</span>
      <span class="entity-type">Consulting</span>
      <span class="entity-chevron">&#9662;</span>
      <div class="entity-dd" onclick="event.stopPropagation()">
        <div class="entity-dd-hdr">Your Entities</div>
        <div class="entity-dd-item active" onclick="selectEntity('Marakana Corp','Consulting',this)">
          <div class="entity-dd-dot" style="background:var(--pri)"></div>
          <div class="entity-dd-info"><div class="entity-dd-name">Marakana Corp</div><div class="entity-dd-meta">Consulting &middot; CAD &middot; 3 accounts</div></div>
          <span class="entity-dd-check">&#10003;</span>
        </div>
        <div class="entity-dd-item" onclick="selectEntity('MK Digital','SaaS',this)">
          <div class="entity-dd-dot" style="background:var(--blue)"></div>
          <div class="entity-dd-info"><div class="entity-dd-name">MK Digital</div><div class="entity-dd-meta">SaaS &middot; USD &middot; 2 accounts</div></div>
          <span class="entity-dd-check" style="opacity:0">&#10003;</span>
        </div>
        <div class="entity-dd-item" onclick="selectEntity('Marakana EU','Services',this)">
          <div class="entity-dd-dot" style="background:var(--purple)"></div>
          <div class="entity-dd-info"><div class="entity-dd-name">Marakana EU</div><div class="entity-dd-meta">Services &middot; EUR &middot; 1 account</div></div>
          <span class="entity-dd-check" style="opacity:0">&#10003;</span>
        </div>
        <div style="border-top:1px solid var(--border);margin-top:4px;padding-top:4px">
          <div class="entity-dd-item" onclick="showToast('Entity creation coming soon')">
            <div class="entity-dd-dot" style="background:var(--t4)"></div>
            <div class="entity-dd-info"><div class="entity-dd-name" style="color:var(--t3)">+ Add Entity</div></div>
          </div>
        </div>
      </div>
    </div>
    <div class="breadcrumb" id="breadcrumb">
      <span class="bc-sep">/</span>
      <span class="bc-active" id="bcPage">Overview</span>
    </div>
    <div class="tb-search">
      <span class="tb-search-icon">&#128269;</span>
      <input class="tb-search-input" id="tbSearch" type="text" placeholder="Search invoices, clients, transactions..." onclick="openCmd()" readonly>
      <span class="tb-search-kbd">/</span>
    </div>
    <div class="tb-right">
      <div class="font-ctl" title="Font size">
        <button class="font-btn" onclick="changeFontSize(-1)">A-</button>
        <button class="font-btn active" onclick="changeFontSize(0)">A</button>
        <button class="font-btn" onclick="changeFontSize(1)">A+</button>
      </div>
      <div class="tb-divider"></div>
      <div class="theme-tog" id="themeTog" onclick="toggleTheme()" title="Toggle theme">
        <span class="t-icon">&#9790;</span>
        <div class="t-track"><div class="t-thumb"></div></div>
        <span class="t-icon">&#9728;</span>
      </div>
      <div class="tb-divider"></div>
      <button class="tb-btn" onclick="showToast('Syncing all accounts...')"><svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M23 4v6h-6M1 20v-6h6"/><path d="M3.51 9a9 9 0 0114.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0020.49 15"/></svg></button>
      <button class="tb-btn" onclick="showToast('No new notifications')"><svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><path d="M18 8A6 6 0 006 8c0 7-3 9-3 9h18s-3-2-3-9M13.73 21a2 2 0 01-3.46 0"/></svg><span class="notif-dot"></span></button>
      <div class="tb-divider"></div>
      <button class="tb-btn" onclick="showToast('Help center opening...')"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5"><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 015.83 1c0 2-3 3-3 3M12 17h.01"/></svg></button>
    </div>
  </header>

  <!-- ═══ MAIN ═══ -->
  <div class="main">

    <!-- OVERVIEW -->
    <div class="view on" id="v-overview">
      <div class="page-hdr fi fi1">
        <div>
          <div class="page-title" id="greeting">Good evening, Sunny</div>
          <div class="page-sub">Sunday, February 9, 2026</div>
        </div>
      </div>

      <section class="pulse fi fi2">
        <div class="p-orb-w"><div class="p-r2"></div><div class="p-r1"></div><div class="p-orb"></div></div>
        <p class="p-text">You have <span class="hl">$47,200</span> across 3 accounts. <span class="pos">$12,400</span> arriving this week from 2 invoices. <span class="warn">$3,200</span> due Friday.</p>
        <div class="curr-strip">
          <div class="curr-item"><span class="c-code">CAD</span><div class="c-bar" style="width:64px;opacity:.5"></div><span class="c-amt">$29,300</span><span class="c-fx up">+0.3%</span></div>
          <div class="curr-item"><span class="c-code">USD</span><div class="c-bar" style="width:36px;opacity:.3"></div><span class="c-amt">$13,200</span><span class="c-fx dn">-0.1%</span></div>
          <div class="curr-item"><span class="c-code">EUR</span><div class="c-bar" style="width:14px;opacity:.2"></div><span class="c-amt">$4,700</span><span class="c-fx up">+2.1%</span></div>
        </div>
      </section>

      <div class="spark-row fi fi3">
        <div class="spark-card"><div class="spark-label">Revenue</div><div style="display:flex;align-items:baseline;gap:8px"><div class="spark-val">$24,800</div><span class="st-trend up">+12%</span></div><div class="spark-line"><svg viewBox="0 0 120 24" preserveAspectRatio="none"><polyline points="0,20 15,18 30,16 45,19 60,14 75,10 90,12 105,8 120,6" fill="none" stroke="rgba(52,211,153,.4)" stroke-width="1.5"/><polyline points="0,20 15,18 30,16 45,19 60,14 75,10 90,12 105,8 120,6" fill="url(#gUp)" stroke="none"/><defs><linearGradient id="gUp" x1="0" y1="0" x2="0" y2="1"><stop offset="0" stop-color="rgba(52,211,153,.12)"/><stop offset="1" stop-color="rgba(52,211,153,0)"/></linearGradient></defs></svg></div></div>
        <div class="spark-card"><div class="spark-label">Expenses</div><div style="display:flex;align-items:baseline;gap:8px"><div class="spark-val">$8,420</div><span class="st-trend dn">+3%</span></div><div class="spark-line"><svg viewBox="0 0 120 24" preserveAspectRatio="none"><polyline points="0,16 15,14 30,15 45,12 60,14 75,10 90,11 105,9 120,8" fill="none" stroke="rgba(248,113,113,.35)" stroke-width="1.5"/><polyline points="0,16 15,14 30,15 45,12 60,14 75,10 90,11 105,9 120,8" fill="url(#gDn)" stroke="none"/><defs><linearGradient id="gDn" x1="0" y1="0" x2="0" y2="1"><stop offset="0" stop-color="rgba(248,113,113,.1)"/><stop offset="1" stop-color="rgba(248,113,113,0)"/></linearGradient></defs></svg></div></div>
        <div class="spark-card"><div class="spark-label">Profit</div><div style="display:flex;align-items:baseline;gap:8px"><div class="spark-val">$16,380</div><span class="st-trend up">+18%</span></div><div class="spark-line"><svg viewBox="0 0 120 24" preserveAspectRatio="none"><polyline points="0,22 15,20 30,18 45,20 60,14 75,12 90,10 105,6 120,4" fill="none" stroke="rgba(245,158,11,.4)" stroke-width="1.5"/><polyline points="0,22 15,20 30,18 45,20 60,14 75,12 90,10 105,6 120,4" fill="url(#gPr)" stroke="none"/><defs><linearGradient id="gPr" x1="0" y1="0" x2="0" y2="1"><stop offset="0" stop-color="rgba(245,158,11,.1)"/><stop offset="1" stop-color="rgba(245,158,11,0)"/></linearGradient></defs></svg></div></div>
        <div class="spark-card"><div class="spark-label">Receivables</div><div style="display:flex;align-items:baseline;gap:8px"><div class="spark-val">$42,800</div><span class="st-trend flat">8 inv</span></div><div class="spark-line"><svg viewBox="0 0 120 24" preserveAspectRatio="none"><polyline points="0,12 15,10 30,14 45,8 60,12 75,10 90,8 105,10 120,9" fill="none" stroke="rgba(96,165,250,.35)" stroke-width="1.5"/></svg></div></div>
        <div class="spark-card"><div class="spark-label">Runway</div><div style="display:flex;align-items:baseline;gap:8px"><div class="spark-val">5.6 mo</div><span class="st-trend flat">Stable</span></div><div class="spark-line"><svg viewBox="0 0 120 24" preserveAspectRatio="none"><polyline points="0,14 15,13 30,12 45,12 60,11 75,11 90,12 105,11 120,10" fill="none" stroke="rgba(167,139,250,.3)" stroke-width="1.5"/></svg></div></div>
      </div>

      <div class="two-col">
        <div>
          <section class="sec fi fi4">
            <div class="sec-h"><h2 class="sec-t">Cash Flow</h2><span class="sec-m">Jan 15 — Mar 15</span></div>
            <div class="river-w" id="riverW"><canvas id="riverC"></canvas><div class="river-today"></div><div class="river-today-l">Today</div><div class="river-tip" id="rTip"><div class="tt-v">$47,200</div><div class="tt-l">Feb 9</div></div></div>
            <div class="river-ax"><span>Jan 15</span><span>Feb 1</span><span>Feb 15</span><span>Mar 1</span><span>Mar 15</span></div>
          </section>
          <section class="sec fi fi5">
            <div class="sec-h"><h2 class="sec-t">Actions</h2><span class="sec-m">3 items</span></div>
            <div class="ac sel" data-a="0" onclick="openDetail('inv-1047')"><div class="ac-i urg">&#9889;</div><div class="ac-b"><div class="ac-t">Send overdue invoice to ABC Corp</div><div class="ac-m"><span>$4,200 USD</span><span class="dot"></span><span>3 days overdue</span></div></div><button class="btn pri" onclick="event.stopPropagation();showToast('Reminder sent to ABC Corp')">Send</button></div>
            <div class="ac" data-a="1" onclick="switchDomain('banking')"><div class="ac-i att">&#128229;</div><div class="ac-b"><div class="ac-t">Categorize 3 bank transactions</div><div class="ac-m"><span>RBC Business</span><span class="dot"></span><span>Imported today</span></div></div><button class="btn" onclick="event.stopPropagation();switchDomain('banking')">Review</button></div>
            <div class="ac" data-a="2" onclick="switchDomain('ai')"><div class="ac-i ai">&#10022;</div><div class="ac-b"><div class="ac-t">EUR exchange rate shifted +2.1%</div><div class="ac-m"><span>Affects 2 invoices</span><span class="dot"></span><span>AI insight</span></div></div><button class="btn" onclick="event.stopPropagation();switchDomain('ai')">Impact</button></div>
          </section>
        </div>
        <div class="right-col fi fi6">
          <div class="ai-brief">
            <div class="ai-hdr"><div class="ai-dot-sm"></div><span class="ai-label">AI Brief</span><span class="ai-time">Feb 9</span></div>
            <p class="ai-body"><strong>Q1 revenue is 23% above last year</strong>, driven by 3 new consulting contracts. Cash runway at 5.6 months. <strong>ABC Corp's payment is 3 days late</strong> — a reminder typically resolves in 48h. EUR strength added <strong>$340 CAD</strong> to receivables.</p>
          </div>
          <div class="sec">
            <div class="sec-h"><h2 class="sec-t">Quick Stats</h2></div>
            <div class="d-row"><span class="d-row-l">Unpaid invoices</span><span class="d-row-v">8</span></div>
            <div class="d-row"><span class="d-row-l">Overdue</span><span class="d-row-v" style="color:var(--red)">1</span></div>
            <div class="d-row"><span class="d-row-l">Pending bills</span><span class="d-row-v">2</span></div>
            <div class="d-row"><span class="d-row-l">Unmatched txns</span><span class="d-row-v" style="color:var(--pri)">12</span></div>
            <div class="d-row"><span class="d-row-l">Reconciled (Feb)</span><span class="d-row-v">78%</span></div>
            <div class="d-row" style="border:none"><span class="d-row-l">Avg days to pay</span><span class="d-row-v">14.2 d</span></div>
          </div>
          <div class="sec">
            <div class="sec-h"><h2 class="sec-t">Upcoming</h2></div>
            <div class="upcoming-item"><div class="upcoming-date"><span class="u-day">14</span><span class="u-mon">Feb</span></div><div class="upcoming-info"><div class="upcoming-name">Maple Digital payment due</div><div class="upcoming-meta">Invoice #1044 &middot; Pending</div></div><div class="upcoming-amt" style="color:var(--green)">+$5,900</div></div>
            <div class="upcoming-item"><div class="upcoming-date"><span class="u-day">14</span><span class="u-mon">Feb</span></div><div class="upcoming-info"><div class="upcoming-name">WeWork rent</div><div class="upcoming-meta">Auto-pay &middot; RBC</div></div><div class="upcoming-amt" style="color:var(--t2)">-$1,800</div></div>
            <div class="upcoming-item"><div class="upcoming-date"><span class="u-day">15</span><span class="u-mon">Feb</span></div><div class="upcoming-info"><div class="upcoming-name">Amex statement closes</div><div class="upcoming-meta">Balance: $2,840 CAD</div></div><div class="upcoming-amt" style="color:var(--t3)">-$2,840</div></div>
            <div class="upcoming-item"><div class="upcoming-date"><span class="u-day">12</span><span class="u-mon">Feb</span></div><div class="upcoming-info"><div class="upcoming-name">TechStart GmbH due</div><div class="upcoming-meta">Invoice #1045 &middot; Sent</div></div><div class="upcoming-amt" style="color:var(--green)">+&euro;6,500</div></div>
          </div>
          <div class="sec">
            <div class="sec-h"><h2 class="sec-t">Recent Activity</h2></div>
            <div style="font-size:11px;color:var(--t3);padding:6px 0;border-bottom:1px solid var(--border);display:flex;justify-content:space-between"><span>XYZ Ltd paid #1046</span><span style="color:var(--green)">+$8,200</span></div>
            <div style="font-size:11px;color:var(--t3);padding:6px 0;border-bottom:1px solid var(--border);display:flex;justify-content:space-between"><span>Wise EUR&#8594;CAD transfer</span><span style="color:var(--green)">+$4,700</span></div>
            <div style="font-size:11px;color:var(--t3);padding:6px 0;border-bottom:1px solid var(--border);display:flex;justify-content:space-between"><span>3 txns imported (RBC)</span><span>Today</span></div>
            <div style="font-size:11px;color:var(--t3);padding:6px 0;display:flex;justify-content:space-between"><span>WeWork rent payment</span><span style="color:var(--t2)">-$1,800</span></div>
          </div>
        </div>
      </div>
    </div>

    <!-- BANKING -->
    <div class="view" id="v-banking">
      <div class="page-hdr fi fi1"><div><div class="page-title">Banking</div><div class="page-sub">3 accounts &middot; 2 currencies &middot; Synced 2 min ago</div></div><div class="page-actions"><button class="btn" onclick="showToast('Syncing all accounts...')">&#128260; Sync All</button><button class="btn pri" onclick="showToast('Import dialog opened')">&#128229; Import CSV</button></div></div>

      <div class="acct-grid fi fi2">
        <div class="acct chk" onclick="openDetail('acct-rbc')"><div class="acct-bank">RBC Royal Bank</div><div class="acct-name">Business Chequing</div><div class="acct-bal">$29,340<span class="acct-cur">CAD</span></div><div class="acct-foot"><span>****4521</span><span class="acct-sync"><span class="dot"></span>Synced</span></div></div>
        <div class="acct sav" onclick="openDetail('acct-wise')"><div class="acct-bank">Wise</div><div class="acct-name">USD Balance</div><div class="acct-bal">$13,160<span class="acct-cur">USD</span></div><div class="acct-foot"><span>Multi-currency</span><span class="acct-sync"><span class="dot"></span>Synced</span></div></div>
        <div class="acct crd" onclick="openDetail('acct-amex')"><div class="acct-bank">American Express</div><div class="acct-name">Business Platinum</div><div class="acct-bal">-$2,840<span class="acct-cur">CAD</span></div><div class="acct-foot"><span>****1008</span><span class="acct-sync"><span class="dot"></span>Synced</span></div></div>
      </div>

      <div class="recon-sec fi fi3"><div class="sec-h"><h2 class="sec-t">Reconciliation — February</h2><span class="sec-m">42 of 54 matched</span></div><div class="recon-bar-w"><div class="recon-bar"><div class="recon-fill" style="width:78%"></div></div><div class="recon-pct">78%</div></div></div>

      <section class="txn-section fi fi4">
        <div class="sec-h"><h2 class="sec-t">Transactions</h2>
          <div class="sec-tabs"><button class="sec-tab on">All</button><button class="sec-tab">Uncategorized</button><button class="sec-tab">Income</button><button class="sec-tab">Expenses</button></div>
        </div>
        <div class="txn-filters">
          <button class="txn-filter on">All Accounts</button>
          <button class="txn-filter">RBC</button>
          <button class="txn-filter">Wise</button>
          <button class="txn-filter">Amex</button>
          <span class="txn-count">54 transactions</span>
        </div>
        <div style="overflow-x:auto">
        <table class="txn-table">
          <thead><tr>
            <th>Date <span class="sort">&#9660;</span></th>
            <th>Description</th>
            <th>Category</th>
            <th>Account</th>
            <th>Reconciled</th>
            <th class="right">Amount</th>
          </tr></thead>
          <tbody>
            <tr class="txn-row uncat" onclick="openDetail('txn-cat')"><td class="txn-date-cell">Feb 9</td><td><div class="txn-desc-cell"><div class="txn-ico" style="background:var(--pri-dim)">&#128230;</div><div class="txn-desc">AMZN MKTP CA*2R4K1</div></div></td><td><span class="txn-cat-tag uncat">Uncategorized</span></td><td class="txn-acct-cell">RBC ****4521</td><td><div class="txn-recon"><span class="r-dot pend"></span>Pending</div></td><td class="txn-amt out">-$84.99</td></tr>
            <tr class="txn-row uncat"><td class="txn-date-cell">Feb 9</td><td><div class="txn-desc-cell"><div class="txn-ico" style="background:var(--pri-dim)">&#127963;</div><div class="txn-desc">UBER TRIP 4X92HJ</div></div></td><td><span class="txn-cat-tag uncat">Uncategorized</span></td><td class="txn-acct-cell">RBC ****4521</td><td><div class="txn-recon"><span class="r-dot pend"></span>Pending</div></td><td class="txn-amt out">-$23.40</td></tr>
            <tr class="txn-row uncat"><td class="txn-date-cell">Feb 8</td><td><div class="txn-desc-cell"><div class="txn-ico" style="background:var(--pri-dim)">&#9749;</div><div class="txn-desc">STARBUCKS #12445</div></div></td><td><span class="txn-cat-tag uncat">Uncategorized</span></td><td class="txn-acct-cell">Amex ****1008</td><td><div class="txn-recon"><span class="r-dot pend"></span>Pending</div></td><td class="txn-amt out">-$6.80</td></tr>
            <tr class="txn-row"><td class="txn-date-cell">Feb 7</td><td><div class="txn-desc-cell"><div class="txn-ico">&#128179;</div><div class="txn-desc">Wise Transfer — EUR to CAD</div></div></td><td><span class="txn-cat-tag">Transfer</span></td><td class="txn-acct-cell">Wise</td><td><div class="txn-recon"><span class="r-dot ok"></span>Matched</div></td><td class="txn-amt in">+$4,700.00</td></tr>
            <tr class="txn-row"><td class="txn-date-cell">Feb 6</td><td><div class="txn-desc-cell"><div class="txn-ico">&#128176;</div><div class="txn-desc">XYZ Ltd — Invoice #1046 Payment</div></div></td><td><span class="txn-cat-tag matched">Client Payment</span></td><td class="txn-acct-cell">RBC ****4521</td><td><div class="txn-recon"><span class="r-dot ok"></span>Matched</div></td><td class="txn-amt in">+$8,200.00</td></tr>
            <tr class="txn-row"><td class="txn-date-cell">Feb 5</td><td><div class="txn-desc-cell"><div class="txn-ico">&#127968;</div><div class="txn-desc">WeWork — Monthly Office Space</div></div></td><td><span class="txn-cat-tag">Rent</span></td><td class="txn-acct-cell">RBC ****4521</td><td><div class="txn-recon"><span class="r-dot ok"></span>Matched</div></td><td class="txn-amt out">-$1,800.00</td></tr>
            <tr class="txn-row"><td class="txn-date-cell">Feb 4</td><td><div class="txn-desc-cell"><div class="txn-ico">&#128187;</div><div class="txn-desc">Vercel Pro — Hosting Subscription</div></div></td><td><span class="txn-cat-tag">SaaS</span></td><td class="txn-acct-cell">Amex ****1008</td><td><div class="txn-recon"><span class="r-dot ok"></span>Matched</div></td><td class="txn-amt out">-$20.00</td></tr>
            <tr class="txn-row"><td class="txn-date-cell">Feb 4</td><td><div class="txn-desc-cell"><div class="txn-ico">&#128187;</div><div class="txn-desc">Linear — Team Plan</div></div></td><td><span class="txn-cat-tag">SaaS</span></td><td class="txn-acct-cell">Amex ****1008</td><td><div class="txn-recon"><span class="r-dot ok"></span>Matched</div></td><td class="txn-amt out">-$48.00</td></tr>
            <tr class="txn-row"><td class="txn-date-cell">Feb 3</td><td><div class="txn-desc-cell"><div class="txn-ico">&#128176;</div><div class="txn-desc">DEF Consulting — Retainer Feb</div></div></td><td><span class="txn-cat-tag matched">Client Payment</span></td><td class="txn-acct-cell">RBC ****4521</td><td><div class="txn-recon"><span class="r-dot ok"></span>Matched</div></td><td class="txn-amt in">+$3,500.00</td></tr>
            <tr class="txn-row"><td class="txn-date-cell">Feb 2</td><td><div class="txn-desc-cell"><div class="txn-ico">&#128179;</div><div class="txn-desc">Wise Transfer — USD to CAD</div></div></td><td><span class="txn-cat-tag">Transfer</span></td><td class="txn-acct-cell">Wise</td><td><div class="txn-recon"><span class="r-dot ok"></span>Matched</div></td><td class="txn-amt in">+$2,800.00</td></tr>
          </tbody>
        </table>
        </div>
      </section>
    </div>

    <!-- INVOICING -->
    <div class="view" id="v-invoicing">
      <div class="page-hdr fi fi1"><div><div class="page-title">Invoicing</div><div class="page-sub">8 invoices &middot; $42,800 outstanding &middot; $12,400 due this week</div></div><div class="page-actions"><button class="btn">&#128200; Reports</button><button class="btn solid" onclick="showToast('New invoice created')">+ New Invoice</button></div></div>

      <div class="stats stats-4 fi fi2">
        <div class="st"><div class="st-label">Outstanding</div><div class="st-val">$42,800</div><div class="st-trend flat">8 invoices</div></div>
        <div class="st"><div class="st-label">Collected (Feb)</div><div class="st-val">$18,600</div><div class="st-trend up">+24%</div></div>
        <div class="st"><div class="st-label">Avg Days to Pay</div><div class="st-val">14.2 d</div><div class="st-trend up">-2.1 days</div></div>
        <div class="st"><div class="st-label">Overdue</div><div class="st-val" style="color:var(--red)">$4,200</div><div class="st-trend dn">1 invoice</div></div>
      </div>

      <section class="sec fi fi3"><div class="sec-h"><h2 class="sec-t">Aging</h2><span class="sec-m">$42,800 total</span></div>
        <div class="aging-bar"><div class="aging-seg" style="flex:48;background:var(--green)"></div><div class="aging-seg" style="flex:28;background:var(--pri)"></div><div class="aging-seg" style="flex:14;background:var(--red)"></div><div class="aging-seg" style="flex:10;background:#DC2626"></div></div>
        <div class="aging-legend"><div class="aging-item"><div class="aging-dot" style="background:var(--green)"></div>Current $20,400</div><div class="aging-item"><div class="aging-dot" style="background:var(--pri)"></div>1-30d $12,200</div><div class="aging-item"><div class="aging-dot" style="background:var(--red)"></div>31-60d $6,000</div><div class="aging-item"><div class="aging-dot" style="background:#DC2626"></div>60+d $4,200</div></div>
      </section>

      <section class="sec fi fi4"><div class="sec-h"><h2 class="sec-t">All Invoices</h2><div class="sec-tabs"><button class="sec-tab on">All</button><button class="sec-tab">Outstanding</button><button class="sec-tab">Paid</button><button class="sec-tab">Draft</button></div></div>
        <div style="overflow-x:auto">
        <table class="inv-table"><thead><tr><th>#</th><th>Client</th><th class="right">Amount</th><th>Status</th><th>Due</th><th>Collection</th></tr></thead><tbody>
          <tr class="inv-row" onclick="openDetail('inv-1047')"><td class="inv-num">#1047</td><td><span class="inv-client">ABC Corp</span><br><span class="inv-client-sub">Consulting Services</span></td><td class="inv-amt">$4,200 <span class="cur">USD</span></td><td><span class="inv-badge overdue">Overdue</span></td><td class="inv-due late">Feb 6</td><td><div class="inv-progress"><div class="inv-pbar"><div class="inv-pfill" style="width:0;background:var(--red)"></div></div><span style="font-size:10px;color:var(--t3)">0%</span></div></td></tr>
          <tr class="inv-row" onclick="openDetail('inv-1046')"><td class="inv-num">#1046</td><td><span class="inv-client">XYZ Ltd</span><br><span class="inv-client-sub">Monthly Retainer</span></td><td class="inv-amt">$8,200 <span class="cur">CAD</span></td><td><span class="inv-badge paid">Paid</span></td><td class="inv-due">Feb 6</td><td><div class="inv-progress"><div class="inv-pbar"><div class="inv-pfill" style="width:100%;background:var(--green)"></div></div><span style="font-size:10px;color:var(--green)">100%</span></div></td></tr>
          <tr class="inv-row"><td class="inv-num">#1045</td><td><span class="inv-client">TechStart GmbH</span><br><span class="inv-client-sub">API Integration</span></td><td class="inv-amt">&euro;6,500 <span class="cur">EUR</span></td><td><span class="inv-badge sent">Sent</span></td><td class="inv-due">Feb 12</td><td><div class="inv-progress"><div class="inv-pbar"><div class="inv-pfill" style="width:0;background:var(--pri)"></div></div><span style="font-size:10px;color:var(--t3)">0%</span></div></td></tr>
          <tr class="inv-row"><td class="inv-num">#1044</td><td><span class="inv-client">Maple Digital</span><br><span class="inv-client-sub">Design System Audit</span></td><td class="inv-amt">$5,900 <span class="cur">CAD</span></td><td><span class="inv-badge pending">Pending</span></td><td class="inv-due">Feb 14</td><td><div class="inv-progress"><div class="inv-pbar"><div class="inv-pfill" style="width:50%;background:var(--pri)"></div></div><span style="font-size:10px;color:var(--t3)">50%</span></div></td></tr>
          <tr class="inv-row"><td class="inv-num">#1043</td><td><span class="inv-client">DEF Consulting</span><br><span class="inv-client-sub">Strategy Workshop</span></td><td class="inv-amt">$3,500 <span class="cur">CAD</span></td><td><span class="inv-badge paid">Paid</span></td><td class="inv-due">Feb 3</td><td><div class="inv-progress"><div class="inv-pbar"><div class="inv-pfill" style="width:100%;background:var(--green)"></div></div><span style="font-size:10px;color:var(--green)">100%</span></div></td></tr>
          <tr class="inv-row"><td class="inv-num">#1042</td><td><span class="inv-client">NovaSync Inc</span><br><span class="inv-client-sub">Platform Migration</span></td><td class="inv-amt">$12,000 <span class="cur">USD</span></td><td><span class="inv-badge draft">Draft</span></td><td class="inv-due">—</td><td><div class="inv-progress"><div class="inv-pbar"><div class="inv-pfill" style="width:0"></div></div><span style="font-size:10px;color:var(--t4)">—</span></div></td></tr>
        </tbody></table>
        </div>
      </section>
    </div>

    <!-- AI ADVISOR -->
    <div class="view" id="v-ai">
      <div class="page-hdr fi fi1"><div><div class="page-title">AI Advisor</div><div class="page-sub">4 new insights &middot; Last analysis: 2 hours ago</div></div><div class="page-actions"><button class="btn pri" onclick="showToast('Running full analysis...')">&#10022; Run Analysis</button></div></div>
      <section class="ai-brief fi fi2" style="margin-bottom:24px"><div class="ai-hdr"><div class="ai-dot-sm"></div><span class="ai-label">Weekly Intelligence Brief</span><span class="ai-time">Feb 9, 2026</span></div><p class="ai-body">Your business is in <strong>strong health</strong>. Revenue grew 23% YoY in Q1 with consulting as the primary driver. Cash runway at 5.6 months is above your 4-month target. The EUR strengthening trend (+2.1% this week) adds <strong>$340 CAD</strong> to receivables. One risk factor: ABC Corp's invoice is now 3 days overdue. Based on their history, a single reminder resolves within 48 hours.</p></section>
      <section class="sec fi fi3"><div class="sec-h"><h2 class="sec-t">Insights</h2><span class="sec-m">4 active</span></div>
        <div class="ai-card" onclick="this.classList.toggle('expanded')"><div style="display:flex;align-items:center"><div style="flex:1"><div class="ai-type saving">&#10003; Cost Saving</div><div class="ai-card-title">Consolidate SaaS subscriptions — save $340/mo</div></div><div class="ai-conf"><div class="ai-conf-bar" style="width:40px"><div class="ai-conf-fill" style="width:88%"></div></div><span>88%</span></div><span class="ai-chevron">&#9662;</span></div><div class="ai-peek">3 overlapping tools detected. Consolidate to save $4,080/year.</div><div class="ai-expand"><div class="ai-card-body">You're paying for 3 project management tools: <strong>Notion ($18/mo)</strong>, <strong>Linear ($48/mo)</strong>, and <strong>Asana ($40/mo)</strong>. Team engagement is 94% on Linear, 12% Notion, 3% Asana. Consolidating to Linear alone saves <strong>$4,080/year</strong>.</div><div class="ai-card-foot"><div class="ai-conf"><span>Confidence</span><div class="ai-conf-bar"><div class="ai-conf-fill" style="width:88%"></div></div><span>88%</span></div><button class="btn pri" onclick="event.stopPropagation();showToast('Added to action items')">Act</button></div></div></div>
        <div class="ai-card" onclick="this.classList.toggle('expanded')"><div style="display:flex;align-items:center"><div style="flex:1"><div class="ai-type growth">&#8599; Growth</div><div class="ai-card-title">EUR clients pay 6 days faster than average</div></div><div class="ai-conf"><div class="ai-conf-bar" style="width:40px"><div class="ai-conf-fill" style="width:94%"></div></div><span>94%</span></div><span class="ai-chevron">&#9662;</span></div><div class="ai-peek">Expand EUR engagements to improve cash flow velocity.</div><div class="ai-expand"><div class="ai-card-body">European clients average <strong>8.3 days</strong> to pay vs your portfolio average of <strong>14.2 days</strong>. TechStart GmbH has paid within 5 days on all 3 invoices. Prioritizing EUR-based contracts could reduce your overall DSO by 20%.</div><div class="ai-card-foot"><div class="ai-conf"><span>Confidence</span><div class="ai-conf-bar"><div class="ai-conf-fill" style="width:94%"></div></div><span>94%</span></div><button class="btn" onclick="event.stopPropagation()">Details</button></div></div></div>
        <div class="ai-card" onclick="this.classList.toggle('expanded')"><div style="display:flex;align-items:center"><div style="flex:1"><div class="ai-type warning">&#9888; Attention</div><div class="ai-card-title">ABC Corp payment 3 days late — unusual</div></div><div class="ai-conf"><div class="ai-conf-bar" style="width:40px"><div class="ai-conf-fill" style="width:76%"></div></div><span>76%</span></div><span class="ai-chevron">&#9662;</span></div><div class="ai-peek">First late payment in 18 months. Reminder recommended.</div><div class="ai-expand"><div class="ai-card-body">ABC Corp typically pays within <strong>2 days</strong> of due date. Invoice #1047 ($4,200 USD) is now 3 days overdue — their first late payment in 18 months. Historical pattern: a single courtesy reminder resolves within <strong>48 hours</strong>. No credit risk indicators detected.</div><div class="ai-card-foot"><div class="ai-conf"><span>Confidence</span><div class="ai-conf-bar"><div class="ai-conf-fill" style="width:76%"></div></div><span>76%</span></div><button class="btn pri" onclick="event.stopPropagation();showToast('Reminder sent')">Remind</button></div></div></div>
        <div class="ai-card" onclick="this.classList.toggle('expanded')"><div style="display:flex;align-items:center"><div style="flex:1"><div class="ai-type risk">&#9888; Risk</div><div class="ai-card-title">Cash dip mid-March if Q2 contracts delayed</div></div><div class="ai-conf"><div class="ai-conf-bar" style="width:40px"><div class="ai-conf-fill" style="width:62%"></div></div><span>62%</span></div><span class="ai-chevron">&#9662;</span></div><div class="ai-peek">Runway could drop below 4-month target by March 20.</div><div class="ai-expand"><div class="ai-card-body">Two pending proposals — <strong>NovaSync ($12,000 USD)</strong> and <strong>Meridian ($8,500 CAD)</strong> — need signatures by March 8. Without them, cash runway drops from 5.6 months to <strong>3.7 months</strong> by March 20, below your 4-month safety target. Consider accelerating proposal follow-ups.</div><div class="ai-card-foot"><div class="ai-conf"><span>Confidence</span><div class="ai-conf-bar"><div class="ai-conf-fill" style="width:62%"></div></div><span>62%</span></div><button class="btn" onclick="event.stopPropagation()">Forecast</button></div></div></div>
      </section>
    </div>

    <!-- PLACEHOLDER VIEWS -->
    <div class="view" id="v-vendors"><div class="page-hdr fi fi1"><div><div class="page-title">Vendors</div><div class="page-sub">2 vendors &middot; $3,200 payable &middot; Next payment Friday</div></div></div><div class="zen"><div class="zen-text">Vendor management coming in Phase 3</div><div class="zen-art"><div class="zen-line"></div><div class="zen-line"></div><div class="zen-line"></div><div class="zen-line"></div><div class="zen-stone"></div><div class="zen-stone"></div><div class="zen-stone"></div></div></div></div>
    <div class="view" id="v-accounting"><div class="page-hdr fi fi1"><div><div class="page-title">Accounting</div><div class="page-sub">General ledger &middot; Journal entries &middot; Chart of accounts</div></div></div><div class="zen"><div class="zen-text">Accounting views arriving soon</div><div class="zen-art"><div class="zen-line"></div><div class="zen-line"></div><div class="zen-line"></div><div class="zen-line"></div><div class="zen-stone"></div><div class="zen-stone"></div><div class="zen-stone"></div></div></div></div>
    <div class="view" id="v-planning"><div class="page-hdr fi fi1"><div><div class="page-title">Planning</div><div class="page-sub">Budgets &middot; Forecasts &middot; Cash flow projections</div></div></div><div class="zen"><div class="zen-text">Financial planning taking shape</div><div class="zen-art"><div class="zen-line"></div><div class="zen-line"></div><div class="zen-line"></div><div class="zen-line"></div><div class="zen-stone"></div><div class="zen-stone"></div><div class="zen-stone"></div></div></div></div>
    <div class="view" id="v-services"><div class="page-hdr fi fi1"><div><div class="page-title">Services</div><div class="page-sub">Bank feeds &middot; Accounting integrations &middot; Webhooks</div></div></div><div class="zen"><div class="zen-text">Integrations hub under construction</div><div class="zen-art"><div class="zen-line"></div><div class="zen-line"></div><div class="zen-line"></div><div class="zen-line"></div><div class="zen-stone"></div><div class="zen-stone"></div><div class="zen-stone"></div></div></div></div>

  </div><!-- /main -->
</div><!-- /shell -->

<!-- DETAIL PANEL -->
<div class="d-overlay" id="dOv"></div>
<div class="d-panel" id="dPan"><button class="d-close" id="dClose">&times;</button><div id="dCon"></div></div>

<!-- COMMAND PALETTE -->
<div class="cmd-overlay" id="cOv"><div class="cmd-box">
  <input class="cmd-input" id="cIn" type="text" placeholder="Search, run actions, or ask AI anything...">
  <div class="cmd-cats">
    <button class="cmd-cat on" data-cat="all" onclick="filterCmdCat('all',this)">All</button>
    <button class="cmd-cat" data-cat="search" onclick="filterCmdCat('search',this)">Search</button>
    <button class="cmd-cat" data-cat="action" onclick="filterCmdCat('action',this)">Actions</button>
    <button class="cmd-cat" data-cat="nav" onclick="filterCmdCat('nav',this)">Navigate</button>
    <button class="cmd-cat" data-cat="ai" onclick="filterCmdCat('ai',this)">Ask AI</button>
  </div>
  <div class="cmd-results" id="cRes"></div>
  <div class="cmd-ai-resp" id="cmdAiResp"></div>
  <div class="cmd-ai-row"><div class="cmd-ai-dot"></div><span class="cmd-ai-hint">Type a question to ask your AI advisor...</span></div>
  <div class="cmd-foot"><span><kbd>&#8593;</kbd><kbd>&#8595;</kbd> Navigate</span><span><kbd>&#9166;</kbd> Open</span><span><kbd>Tab</kbd> Category</span><span><kbd>esc</kbd> Close</span></div>
</div></div>

<!-- TOAST -->
<div class="toast" id="toast"><span class="t-ico">&#10003;</span><span id="tMsg"></span></div>

<!-- KB BAR -->
<div class="kb"><span><kbd>j</kbd><kbd>k</kbd> Nav</span><span><kbd>&#9166;</kbd> Open</span><span><kbd>/</kbd> Search</span><span><kbd>1</kbd>-<kbd>8</kbd> Domain</span><span><kbd>Esc</kbd> Back</span></div>

<script>
// ═══ STATE ═══
let curDom='overview',detOpen=false,cmdOpen=false,selAc=0;
const domNames={overview:'Overview',banking:'Banking',invoicing:'Invoicing',vendors:'Vendors',accounting:'Accounting',planning:'Planning',ai:'AI Advisor',services:'Services'};

// ═══ DETAIL TEMPLATES ═══
const DT={
'inv-1047':`<span class="d-badge overdue">3 days overdue</span><h2 class="d-title">Invoice #1047</h2><p class="d-sub">ABC Corp — Consulting Services</p><div class="d-amount">$4,200.00 <span class="cur">USD</span></div><div class="d-row"><span class="d-row-l">Issue Date</span><span class="d-row-v">Jan 28, 2026</span></div><div class="d-row"><span class="d-row-l">Due Date</span><span class="d-row-v" style="color:var(--red)">Feb 6, 2026</span></div><div class="d-row"><span class="d-row-l">Client</span><span class="d-row-v">sarah@abccorp.com</span></div><div class="d-row"><span class="d-row-l">FX Rate</span><span class="d-row-v">1.3520 USD→CAD</span></div><div class="d-row"><span class="d-row-l">CAD Amount</span><span class="d-row-v">$5,678.40</span></div><div class="d-row"><span class="d-row-l">Entity</span><span class="d-row-v">Marakana Corp</span></div><div class="d-row"><span class="d-row-l">GL Account</span><span class="d-row-v">1200 — Accounts Receivable</span></div><div class="d-actions"><button class="btn pri" onclick="showToast('Reminder sent')">&#9993; Send Reminder</button><button class="btn" onclick="showToast('Marked as paid');closeDetail()">&#10003; Mark as Paid</button><button class="btn">&#128196; View PDF</button><button class="btn">&#128337; Payment History</button><button class="btn">&#9998; Edit Invoice</button></div>`,
'inv-1046':`<span class="d-badge paid">Paid</span><h2 class="d-title">Invoice #1046</h2><p class="d-sub">XYZ Ltd — Monthly Retainer</p><div class="d-amount">$8,200.00 <span class="cur">CAD</span></div><div class="d-row"><span class="d-row-l">Issue Date</span><span class="d-row-v">Jan 22, 2026</span></div><div class="d-row"><span class="d-row-l">Paid Date</span><span class="d-row-v" style="color:var(--green)">Feb 6, 2026</span></div><div class="d-row"><span class="d-row-l">Payment</span><span class="d-row-v">Wire Transfer</span></div><div class="d-row"><span class="d-row-l">Days to Pay</span><span class="d-row-v">15 days</span></div><div class="d-row"><span class="d-row-l">Entity</span><span class="d-row-v">Marakana Corp</span></div><div class="d-row"><span class="d-row-l">Journal Entry</span><span class="d-row-v" style="color:var(--pri)">#JE-2026-0042</span></div><div class="d-actions"><button class="btn">&#128196; View PDF</button><button class="btn">&#128337; Payment History</button><button class="btn">&#128260; Create Recurring</button></div>`,
'acct-rbc':`<h2 class="d-title">RBC Business Chequing</h2><p class="d-sub">****4521 &middot; Royal Bank of Canada</p><div class="d-amount">$29,340.00 <span class="cur">CAD</span></div><div class="d-row"><span class="d-row-l">Available</span><span class="d-row-v">$29,340.00</span></div><div class="d-row"><span class="d-row-l">Pending</span><span class="d-row-v">$0.00</span></div><div class="d-row"><span class="d-row-l">Last Sync</span><span class="d-row-v">2 min ago</span></div><div class="d-row"><span class="d-row-l">Txns (Feb)</span><span class="d-row-v">34</span></div><div class="d-row"><span class="d-row-l">Unmatched</span><span class="d-row-v" style="color:var(--pri)">8</span></div><div class="d-row"><span class="d-row-l">Entity</span><span class="d-row-v">Marakana Corp</span></div><div class="d-row"><span class="d-row-l">GL Account</span><span class="d-row-v">1000 — Cash</span></div><div class="d-actions"><button class="btn pri">&#128260; Sync Now</button><button class="btn">&#128200; Statement</button><button class="btn">&#128229; Import CSV</button><button class="btn">&#9881; Settings</button></div>`,
'acct-wise':`<h2 class="d-title">Wise USD Balance</h2><p class="d-sub">Multi-currency &middot; Wise Business</p><div class="d-amount">$13,160.00 <span class="cur">USD</span></div><div class="d-row"><span class="d-row-l">CAD Equiv.</span><span class="d-row-v">$17,796.20</span></div><div class="d-row"><span class="d-row-l">FX Rate</span><span class="d-row-v">1.3524</span></div><div class="d-row"><span class="d-row-l">EUR Balance</span><span class="d-row-v">&euro;3,480.00</span></div><div class="d-row"><span class="d-row-l">Entity</span><span class="d-row-v">Marakana Corp</span></div><div class="d-actions"><button class="btn pri">&#128260; Sync Now</button><button class="btn">&#128179; Convert</button><button class="btn">&#128200; Statement</button></div>`,
'acct-amex':`<h2 class="d-title">Amex Business Platinum</h2><p class="d-sub">****1008 &middot; American Express</p><div class="d-amount" style="color:var(--red)">-$2,840.00 <span class="cur">CAD</span></div><div class="d-row"><span class="d-row-l">Limit</span><span class="d-row-v">$25,000</span></div><div class="d-row"><span class="d-row-l">Available</span><span class="d-row-v">$22,160</span></div><div class="d-row"><span class="d-row-l">Statement</span><span class="d-row-v">Feb 15</span></div><div class="d-row"><span class="d-row-l">Payment Due</span><span class="d-row-v">Mar 5</span></div><div class="d-row"><span class="d-row-l">Entity</span><span class="d-row-v">Marakana Corp</span></div><div class="d-actions"><button class="btn pri">&#128176; Pay Balance</button><button class="btn">&#128200; Statement</button></div>`,
'txn-cat':`<span class="d-badge uncat">Uncategorized</span><h2 class="d-title">AMZN MKTP CA*2R4K1</h2><p class="d-sub">RBC ****4521 &middot; Feb 9, 2026</p><div class="d-amount">-$84.99 <span class="cur">CAD</span></div><div class="d-row"><span class="d-row-l">Type</span><span class="d-row-v">Debit — Purchase</span></div><div class="d-row"><span class="d-row-l">AI Suggestion</span><span class="d-row-v" style="color:var(--pri)">Office Supplies (87%)</span></div><div class="d-row"><span class="d-row-l">Alt. Suggestion</span><span class="d-row-v">Computer Equipment (9%)</span></div><div class="d-row"><span class="d-row-l">Matched Invoice</span><span class="d-row-v">None</span></div><div class="d-row"><span class="d-row-l">Entity</span><span class="d-row-v">Marakana Corp</span></div><div class="d-row"><span class="d-row-l">GL Account</span><span class="d-row-v">—</span></div><div class="d-actions"><button class="btn pri" onclick="showToast('Categorized as Office Supplies')">&#10003; Accept: Office Supplies</button><button class="btn">&#128193; Choose Category</button><button class="btn">&#128260; Split Transaction</button><button class="btn">&#128065; Attach Receipt</button><button class="btn">&#128172; Add Note</button></div>`,
};

// ═══ THEME ═══
let isLight=false;
function toggleTheme(){
  isLight=!isLight;
  document.documentElement.classList.toggle('light',isLight);
  document.getElementById('themeTog').classList.toggle('light-on',isLight);
  showToast(isLight?'Light mode':'Dark mode');
}

// ═══ FONT SIZE ═══
const fontSizes=[13,15,17];
let fontIdx=1;
function changeFontSize(dir){
  if(dir===0)fontIdx=1;
  else fontIdx=Math.max(0,Math.min(2,fontIdx+dir));
  document.documentElement.style.fontSize=fontSizes[fontIdx]+'px';
  document.querySelectorAll('.font-btn').forEach((b,i)=>b.classList.toggle('active',i===fontIdx));
  showToast('Font size: '+['Small','Normal','Large'][fontIdx]);
}

// ═══ COMMAND DATA ═══
const CD=[
{i:'&#128196;',t:'Invoice #1047 — ABC Corp',d:'$4,200 USD · Overdue',cat:'search',a:()=>openDetail('inv-1047')},
{i:'&#128196;',t:'Invoice #1046 — XYZ Ltd',d:'$8,200 CAD · Paid',cat:'search',a:()=>openDetail('inv-1046')},
{i:'&#128196;',t:'Invoice #1045 — TechStart GmbH',d:'€6,500 EUR · Sent',cat:'search',a:()=>{}},
{i:'&#128176;',t:'RBC Business Chequing',d:'$29,340 CAD',cat:'search',a:()=>switchDomain('banking')},
{i:'&#128176;',t:'Wise USD Balance',d:'$13,160 USD',cat:'search',a:()=>switchDomain('banking')},
{i:'&#128100;',t:'ABC Corp',d:'Client · 12 invoices · $48,600 total',cat:'search',a:()=>{}},
{i:'&#128100;',t:'XYZ Ltd',d:'Client · 8 invoices · $32,400 total',cat:'search',a:()=>{}},
{i:'&#128100;',t:'TechStart GmbH',d:'Client · 3 invoices · €19,500 total',cat:'search',a:()=>{}},
{i:'&#10022;',t:'New Invoice',d:'Create a new invoice',k:'n',cat:'action',a:()=>showToast('New invoice form opened')},
{i:'&#10022;',t:'New Transaction',d:'Add manual transaction',cat:'action',a:()=>showToast('Transaction form opened')},
{i:'&#128260;',t:'Sync All Accounts',d:'Refresh bank feeds',cat:'action',a:()=>showToast('Syncing all accounts...')},
{i:'&#128179;',t:'Export Report',d:'Download PDF/CSV report',cat:'action',a:()=>showToast('Export dialog opened')},
{i:'&#127969;',t:'Overview',d:'Dashboard & financial pulse',cat:'nav',a:()=>switchDomain('overview')},
{i:'&#127963;',t:'Banking',d:'Accounts & transactions',cat:'nav',a:()=>switchDomain('banking')},
{i:'&#128196;',t:'Invoicing',d:'Invoices & clients',cat:'nav',a:()=>switchDomain('invoicing')},
{i:'&#129302;',t:'AI Advisor',d:'Insights & recommendations',cat:'nav',a:()=>switchDomain('ai')},
{i:'&#128200;',t:'Planning',d:'Budgets & forecasts',cat:'nav',a:()=>switchDomain('planning')},
];
let CF=[...CD],cSel=0,cmdCat='all';

// AI responses for the "Ask AI" feature
const aiResponses={
  'revenue':'Your <strong>Q1 revenue is $24,800</strong>, up 23% from last year. Consulting services drive 78% of income. Top client: XYZ Ltd ($32,400 lifetime).',
  'cash':'Current cash position: <strong>$47,200 across 3 accounts</strong>. CAD: $29,300 | USD: $13,200 | EUR: $4,700. Runway: 5.6 months at current burn rate.',
  'overdue':'<strong>1 invoice overdue</strong>: #1047 to ABC Corp for $4,200 USD (3 days late). Their payment history suggests a reminder will resolve in ~48 hours.',
  'profit':'February profit: <strong>$16,380</strong> (66% margin). Up 18% from January. Largest expense: WeWork rent ($1,800/mo). SaaS tools: $340/mo (consolidation opportunity).',
  'default':'I can help with questions about your <strong>revenue</strong>, <strong>cash position</strong>, <strong>overdue invoices</strong>, <strong>profit margins</strong>, <strong>runway</strong>, or any financial metric. What would you like to know?'
};

function filterCmdCat(cat,el){
  cmdCat=cat;
  document.querySelectorAll('.cmd-cat').forEach(c=>c.classList.toggle('on',c.dataset.cat===cat));
  const q=document.getElementById('cIn').value.toLowerCase();
  filterCmdItems(q);
}

function filterCmdItems(q){
  document.getElementById('cmdAiResp').classList.remove('vis');
  if(cmdCat==='ai'){
    CF=[];cSel=0;renderCmd();
    if(q.length>2){
      let resp=aiResponses.default;
      for(const[k,v]of Object.entries(aiResponses)){if(k!=='default'&&q.includes(k)){resp=v;break;}}
      document.getElementById('cmdAiResp').innerHTML=resp;
      document.getElementById('cmdAiResp').classList.add('vis');
    }
    return;
  }
  CF=CD.filter(c=>{
    if(cmdCat!=='all'&&c.cat!==cmdCat)return false;
    if(q)return(c.t+c.d).toLowerCase().includes(q);
    return true;
  });
  cSel=0;renderCmd();
}

// ═══ DOMAIN SWITCHING ═══
function switchDomain(d){
  if(curDom===d)return;
  const p=document.getElementById('v-'+curDom),n=document.getElementById('v-'+d);
  if(!n)return;
  if(p){p.style.opacity='0';p.style.transform='translateY(-6px)';}
  setTimeout(()=>{
    document.querySelectorAll('.view').forEach(v=>{v.classList.remove('on');v.style.opacity='';v.style.transform='';});
    n.classList.add('on');
    n.querySelectorAll('.fi').forEach(e=>{e.style.animation='none';e.offsetHeight;e.style.animation='';});
    if(d==='overview')setTimeout(drawRiver,80);
  },180);
  document.querySelectorAll('.s-btn[data-d]').forEach(b=>b.classList.toggle('on',b.dataset.d===d));
  document.getElementById('bcPage').textContent=domNames[d]||d;
  curDom=d;closeDetail();closeCmd();
}
document.querySelectorAll('.s-btn[data-d]').forEach(b=>b.addEventListener('click',()=>switchDomain(b.dataset.d)));

// ═══ ENTITY SELECTOR ═══
function selectEntity(name,type,el){
  document.getElementById('entityName').textContent=name;
  document.querySelector('.entity-type').textContent=type;
  document.querySelectorAll('.entity-dd-item').forEach(i=>{i.classList.remove('active');i.querySelector('.entity-dd-check').style.opacity='0';});
  el.classList.add('active');el.querySelector('.entity-dd-check').style.opacity='1';
  document.getElementById('entitySel').classList.remove('open');
  showToast('Switched to '+name);
}

// ═══ DETAIL ═══
function openDetail(id){const c=DT[id];if(c)document.getElementById('dCon').innerHTML=c;document.getElementById('dOv').classList.add('vis');document.getElementById('dPan').classList.add('vis');detOpen=true;}
function closeDetail(){document.getElementById('dOv').classList.remove('vis');document.getElementById('dPan').classList.remove('vis');detOpen=false;}
document.getElementById('dOv').addEventListener('click',closeDetail);
document.getElementById('dClose').addEventListener('click',closeDetail);

// ═══ COMMAND PALETTE ═══
function openCmd(){document.getElementById('cOv').classList.add('vis');document.getElementById('cIn').value='';cmdCat='all';document.querySelectorAll('.cmd-cat').forEach(c=>c.classList.toggle('on',c.dataset.cat==='all'));document.getElementById('cmdAiResp').classList.remove('vis');CF=[...CD];cSel=0;renderCmd();setTimeout(()=>document.getElementById('cIn').focus(),40);cmdOpen=true;}
function closeCmd(){document.getElementById('cOv').classList.remove('vis');cmdOpen=false;}
function renderCmd(){const el=document.getElementById('cRes');el.innerHTML=CF.map((c,i)=>`<div class="cmd-item${i===cSel?' sel':''}" data-i="${i}"><div class="cmd-ii">${c.i}</div><div class="cmd-it"><div class="cmd-itn">${c.t}</div><div class="cmd-itd">${c.d}</div></div>${c.k?`<span class="cmd-ik">${c.k}</span>`:''}</div>`).join('');el.querySelectorAll('.cmd-item').forEach(ci=>ci.addEventListener('click',()=>{CF[+ci.dataset.i]?.a();closeCmd();}));}
document.getElementById('cIn').addEventListener('input',e=>{filterCmdItems(e.target.value.toLowerCase());});
document.getElementById('cOv').addEventListener('click',e=>{if(e.target===document.getElementById('cOv'))closeCmd();});

// ═══ CLOSE ENTITY ON OUTSIDE CLICK ═══
document.addEventListener('click',e=>{if(!document.getElementById('entitySel').contains(e.target))document.getElementById('entitySel').classList.remove('open');});

// ═══ TOAST ═══
let tT;function showToast(m){clearTimeout(tT);document.getElementById('tMsg').textContent=m;document.getElementById('toast').classList.add('vis');tT=setTimeout(()=>document.getElementById('toast').classList.remove('vis'),2600);}

// ═══ KEYBOARD ═══
document.addEventListener('keydown',e=>{
  if(cmdOpen){if(e.key==='Escape'){closeCmd();e.preventDefault();}else if(e.key==='ArrowDown'){cSel=Math.min(cSel+1,CF.length-1);renderCmd();e.preventDefault();}else if(e.key==='ArrowUp'){cSel=Math.max(cSel-1,0);renderCmd();e.preventDefault();}else if(e.key==='Enter'){if(cmdCat==='ai'){const q=document.getElementById('cIn').value.toLowerCase();filterCmdItems(q);}else{CF[cSel]?.a();closeCmd();}e.preventDefault();}else if(e.key==='Tab'){e.preventDefault();const cats=['all','search','action','nav','ai'];const ci=(cats.indexOf(cmdCat)+1)%cats.length;filterCmdCat(cats[ci],null);document.querySelectorAll('.cmd-cat').forEach(c=>c.classList.toggle('on',c.dataset.cat===cats[ci]));}return;}
  if(detOpen){if(e.key==='Escape'){closeDetail();e.preventDefault();}return;}
  if(document.activeElement&&document.activeElement.tagName==='INPUT')return;
  const acs=document.querySelectorAll('#v-overview .ac');
  switch(e.key){
    case'j':if(curDom==='overview'&&acs.length){selAc=Math.min(selAc+1,acs.length-1);acs.forEach((c,i)=>c.classList.toggle('sel',i===selAc));}e.preventDefault();break;
    case'k':if(curDom==='overview'&&acs.length){selAc=Math.max(selAc-1,0);acs.forEach((c,i)=>c.classList.toggle('sel',i===selAc));}e.preventDefault();break;
    case'Enter':case' ':if(curDom==='overview')openDetail('inv-1047');e.preventDefault();break;
    case'/':openCmd();e.preventDefault();break;
    case'1':switchDomain('overview');e.preventDefault();break;case'2':switchDomain('banking');e.preventDefault();break;
    case'3':switchDomain('invoicing');e.preventDefault();break;case'4':switchDomain('vendors');e.preventDefault();break;
    case'5':switchDomain('accounting');e.preventDefault();break;case'6':switchDomain('planning');e.preventDefault();break;
    case'7':switchDomain('ai');e.preventDefault();break;case'8':switchDomain('services');e.preventDefault();break;
  }
});

// ═══ TAB SWITCHING ═══
document.querySelectorAll('.sec-tabs').forEach(g=>{g.querySelectorAll('.sec-tab').forEach(t=>t.addEventListener('click',()=>{g.querySelectorAll('.sec-tab').forEach(x=>x.classList.remove('on'));t.classList.add('on');}));});
document.querySelectorAll('.txn-filter').forEach(f=>f.addEventListener('click',()=>{f.parentElement.querySelectorAll('.txn-filter').forEach(x=>x.classList.remove('on'));f.classList.add('on');}));

// ═══ RIVER ═══
function drawRiver(){
  const c=document.getElementById('riverC');if(!c||!c.offsetWidth)return;
  const ctx=c.getContext('2d'),dpr=window.devicePixelRatio||1;
  c.width=c.offsetWidth*dpr;c.height=c.offsetHeight*dpr;ctx.scale(dpr,dpr);
  const w=c.offsetWidth,h=c.offsetHeight,mid=h*.5;
  const pts=[{x:0,t:-28,b:28},{x:.08,t:-26,b:26},{x:.18,t:-34,b:34},{x:.28,t:-24,b:24},{x:.35,t:-28,b:28},{x:.42,t:-30,b:30},{x:.5,t:-22,b:22},{x:.58,t:-36,b:36},{x:.68,t:-32,b:32},{x:.78,t:-26,b:26},{x:.88,t:-32,b:32},{x:1,t:-38,b:38}];
  function gY(n,s){for(let i=0;i<pts.length-1;i++)if(n>=pts[i].x&&n<=pts[i+1].x){const t2=(n-pts[i].x)/(pts[i+1].x-pts[i].x),sm=t2*t2*(3-2*t2);return mid+(s==='t'?pts[i].t+(pts[i+1].t-pts[i].t)*sm:pts[i].b+(pts[i+1].b-pts[i].b)*sm);}return mid;}
  ctx.beginPath();for(let x=0;x<=w;x+=2)ctx.lineTo(x,gY(x/w,'t'));for(let x=w;x>=0;x-=2)ctx.lineTo(x,gY(x/w,'b'));ctx.closePath();
  const g=ctx.createLinearGradient(0,mid-40,0,mid+40);g.addColorStop(0,'rgba(245,158,11,.08)');g.addColorStop(.5,'rgba(245,158,11,.03)');g.addColorStop(1,'rgba(245,158,11,.08)');ctx.fillStyle=g;ctx.fill();
  [['t','rgba(245,158,11,.22)',1.5],['b','rgba(245,158,11,.1)',1]].forEach(([s,col,lw])=>{ctx.beginPath();for(let x=0;x<=w;x+=2)ctx.lineTo(x,gY(x/w,s));ctx.strokeStyle=col;ctx.lineWidth=lw;ctx.stroke();});
  [{x:.18,a:'$8,400'},{x:.58,a:'$12,400'},{x:.82,a:'$6,800'}].forEach(s=>{const px=s.x*w,ry=gY(s.x,'t');ctx.beginPath();ctx.moveTo(px,8);ctx.quadraticCurveTo(px+2,(8+ry)/2,px,ry);ctx.strokeStyle='rgba(52,211,153,.2)';ctx.lineWidth=1.5;ctx.stroke();const g2=ctx.createRadialGradient(px,ry,0,px,ry,8);g2.addColorStop(0,'rgba(52,211,153,.15)');g2.addColorStop(1,'transparent');ctx.fillStyle=g2;ctx.beginPath();ctx.arc(px,ry,8,0,Math.PI*2);ctx.fill();ctx.font='500 8px Manrope';ctx.fillStyle='rgba(52,211,153,.5)';ctx.textAlign='center';ctx.fillText(s.a,px,6);});
  [{x:.28,a:'$2,100'},{x:.48,a:'$3,200'},{x:.72,a:'$1,800'}].forEach(s=>{const px=s.x*w,ry=gY(s.x,'b');ctx.beginPath();ctx.moveTo(px,ry);ctx.quadraticCurveTo(px-2,(ry+h-8)/2,px,h-8);ctx.strokeStyle='rgba(248,113,113,.16)';ctx.lineWidth=1.5;ctx.stroke();const g2=ctx.createRadialGradient(px,ry,0,px,ry,8);g2.addColorStop(0,'rgba(248,113,113,.12)');g2.addColorStop(1,'transparent');ctx.fillStyle=g2;ctx.beginPath();ctx.arc(px,ry,8,0,Math.PI*2);ctx.fill();ctx.font='500 8px Manrope';ctx.fillStyle='rgba(248,113,113,.4)';ctx.textAlign='center';ctx.fillText(s.a,px,h-2);});
}
const rW=document.getElementById('riverW'),rT=document.getElementById('rTip');
if(rW){rW.addEventListener('mousemove',e=>{const r=rW.getBoundingClientRect(),x=e.clientX-r.left,p=x/r.width;const bals=[42e3,40200,44800,38600,41200,43500,39200,47200,44800,41600,44200,49400];const i=Math.min(Math.floor(p*(bals.length-1)),bals.length-2),t=p*(bals.length-1)-i,v=Math.round(bals[i]+(bals[i+1]-bals[i])*t);rT.querySelector('.tt-v').textContent='$'+v.toLocaleString();const d=new Date(2026,0,15+Math.round(p*60));rT.querySelector('.tt-l').textContent=d.toLocaleDateString('en-US',{month:'short',day:'numeric'});rT.style.left=Math.min(x+10,r.width-100)+'px';rT.style.top=(e.clientY-r.top-44)+'px';rT.classList.add('show');});rW.addEventListener('mouseleave',()=>rT.classList.remove('show'));}

// ═══ INIT ═══
window.addEventListener('load',()=>{
  drawRiver();window.addEventListener('resize',drawRiver);
  const h=new Date().getHours();const g=h<12?'Good morning':h<17?'Good afternoon':'Good evening';
  document.getElementById('greeting').innerHTML=g+', <strong>Sunny</strong>';
});
</script>
</body>
</html>